241d0e76c295688102c66f6a503bfc82
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

exports.__esModule = true;
exports["default"] = connectAdvanced;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectWithoutPropertiesLoose2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutPropertiesLoose"));

var _hoistNonReactStatics = _interopRequireDefault(require("hoist-non-react-statics"));

var _react = _interopRequireWildcard(require("react"));

var _reactIs = require("react-is");

var _Subscription = _interopRequireDefault(require("../utils/Subscription"));

var _useIsomorphicLayoutEffect = require("../utils/useIsomorphicLayoutEffect");

var _Context = require("./Context");

var EMPTY_ARRAY = [];
var NO_SUBSCRIPTION_ARRAY = [null, null];

var stringifyComponent = function stringifyComponent(Comp) {
  try {
    return JSON.stringify(Comp);
  } catch (err) {
    return String(Comp);
  }
};

function storeStateUpdatesReducer(state, action) {
  var updateCount = state[1];
  return [action.payload, updateCount + 1];
}

function useIsomorphicLayoutEffectWithArgs(effectFunc, effectArgs, dependencies) {
  (0, _useIsomorphicLayoutEffect.useIsomorphicLayoutEffect)(function () {
    return effectFunc.apply(void 0, effectArgs);
  }, dependencies);
}

function captureWrapperProps(lastWrapperProps, lastChildProps, renderIsScheduled, wrapperProps, actualChildProps, childPropsFromStoreUpdate, notifyNestedSubs) {
  lastWrapperProps.current = wrapperProps;
  lastChildProps.current = actualChildProps;
  renderIsScheduled.current = false;

  if (childPropsFromStoreUpdate.current) {
    childPropsFromStoreUpdate.current = null;
    notifyNestedSubs();
  }
}

function subscribeUpdates(shouldHandleStateChanges, store, subscription, childPropsSelector, lastWrapperProps, lastChildProps, renderIsScheduled, childPropsFromStoreUpdate, notifyNestedSubs, forceComponentUpdateDispatch) {
  if (!shouldHandleStateChanges) return;
  var didUnsubscribe = false;
  var lastThrownError = null;

  var checkForUpdates = function checkForUpdates() {
    if (didUnsubscribe) {
      return;
    }

    var latestStoreState = store.getState();
    var newChildProps, error;

    try {
      newChildProps = childPropsSelector(latestStoreState, lastWrapperProps.current);
    } catch (e) {
      error = e;
      lastThrownError = e;
    }

    if (!error) {
      lastThrownError = null;
    }

    if (newChildProps === lastChildProps.current) {
      if (!renderIsScheduled.current) {
        notifyNestedSubs();
      }
    } else {
      lastChildProps.current = newChildProps;
      childPropsFromStoreUpdate.current = newChildProps;
      renderIsScheduled.current = true;
      forceComponentUpdateDispatch({
        type: 'STORE_UPDATED',
        payload: {
          error: error
        }
      });
    }
  };

  subscription.onStateChange = checkForUpdates;
  subscription.trySubscribe();
  checkForUpdates();

  var unsubscribeWrapper = function unsubscribeWrapper() {
    didUnsubscribe = true;
    subscription.tryUnsubscribe();
    subscription.onStateChange = null;

    if (lastThrownError) {
      throw lastThrownError;
    }
  };

  return unsubscribeWrapper;
}

var initStateUpdates = function initStateUpdates() {
  return [null, 0];
};

function connectAdvanced(selectorFactory, _ref) {
  if (_ref === void 0) {
    _ref = {};
  }

  var _ref2 = _ref,
      _ref2$getDisplayName = _ref2.getDisplayName,
      getDisplayName = _ref2$getDisplayName === void 0 ? function (name) {
    return "ConnectAdvanced(" + name + ")";
  } : _ref2$getDisplayName,
      _ref2$methodName = _ref2.methodName,
      methodName = _ref2$methodName === void 0 ? 'connectAdvanced' : _ref2$methodName,
      _ref2$renderCountProp = _ref2.renderCountProp,
      renderCountProp = _ref2$renderCountProp === void 0 ? undefined : _ref2$renderCountProp,
      _ref2$shouldHandleSta = _ref2.shouldHandleStateChanges,
      shouldHandleStateChanges = _ref2$shouldHandleSta === void 0 ? true : _ref2$shouldHandleSta,
      _ref2$storeKey = _ref2.storeKey,
      storeKey = _ref2$storeKey === void 0 ? 'store' : _ref2$storeKey,
      _ref2$withRef = _ref2.withRef,
      withRef = _ref2$withRef === void 0 ? false : _ref2$withRef,
      _ref2$forwardRef = _ref2.forwardRef,
      forwardRef = _ref2$forwardRef === void 0 ? false : _ref2$forwardRef,
      _ref2$context = _ref2.context,
      context = _ref2$context === void 0 ? _Context.ReactReduxContext : _ref2$context,
      connectOptions = (0, _objectWithoutPropertiesLoose2["default"])(_ref2, ["getDisplayName", "methodName", "renderCountProp", "shouldHandleStateChanges", "storeKey", "withRef", "forwardRef", "context"]);

  if (process.env.NODE_ENV !== 'production') {
    if (renderCountProp !== undefined) {
      throw new Error("renderCountProp is removed. render counting is built into the latest React Dev Tools profiling extension");
    }

    if (withRef) {
      throw new Error('withRef is removed. To access the wrapped instance, use a ref on the connected component');
    }

    var customStoreWarningMessage = 'To use a custom Redux store for specific components, create a custom React context with ' + "React.createContext(), and pass the context object to React Redux's Provider and specific components" + ' like: <Provider context={MyContext}><ConnectedComponent context={MyContext} /></Provider>. ' + 'You may also pass a {context : MyContext} option to connect';

    if (storeKey !== 'store') {
      throw new Error('storeKey has been removed and does not do anything. ' + customStoreWarningMessage);
    }
  }

  var Context = context;
  return function wrapWithConnect(WrappedComponent) {
    if (process.env.NODE_ENV !== 'production' && !(0, _reactIs.isValidElementType)(WrappedComponent)) {
      throw new Error("You must pass a component to the function returned by " + (methodName + ". Instead received " + stringifyComponent(WrappedComponent)));
    }

    var wrappedComponentName = WrappedComponent.displayName || WrappedComponent.name || 'Component';
    var displayName = getDisplayName(wrappedComponentName);
    var selectorFactoryOptions = (0, _extends2["default"])({}, connectOptions, {
      getDisplayName: getDisplayName,
      methodName: methodName,
      renderCountProp: renderCountProp,
      shouldHandleStateChanges: shouldHandleStateChanges,
      storeKey: storeKey,
      displayName: displayName,
      wrappedComponentName: wrappedComponentName,
      WrappedComponent: WrappedComponent
    });
    var pure = connectOptions.pure;

    function createChildSelector(store) {
      return selectorFactory(store.dispatch, selectorFactoryOptions);
    }

    var usePureOnlyMemo = pure ? _react.useMemo : function (callback) {
      return callback();
    };

    function ConnectFunction(props) {
      var _useMemo = (0, _react.useMemo)(function () {
        var reactReduxForwardedRef = props.reactReduxForwardedRef,
            wrapperProps = (0, _objectWithoutPropertiesLoose2["default"])(props, ["reactReduxForwardedRef"]);
        return [props.context, reactReduxForwardedRef, wrapperProps];
      }, [props]),
          propsContext = _useMemo[0],
          reactReduxForwardedRef = _useMemo[1],
          wrapperProps = _useMemo[2];

      var ContextToUse = (0, _react.useMemo)(function () {
        return propsContext && propsContext.Consumer && (0, _reactIs.isContextConsumer)(_react["default"].createElement(propsContext.Consumer, null)) ? propsContext : Context;
      }, [propsContext, Context]);
      var contextValue = (0, _react.useContext)(ContextToUse);
      var didStoreComeFromProps = Boolean(props.store) && Boolean(props.store.getState) && Boolean(props.store.dispatch);
      var didStoreComeFromContext = Boolean(contextValue) && Boolean(contextValue.store);

      if (process.env.NODE_ENV !== 'production' && !didStoreComeFromProps && !didStoreComeFromContext) {
        throw new Error("Could not find \"store\" in the context of " + ("\"" + displayName + "\". Either wrap the root component in a <Provider>, ") + "or pass a custom React context provider to <Provider> and the corresponding " + ("React context consumer to " + displayName + " in connect options."));
      }

      var store = didStoreComeFromProps ? props.store : contextValue.store;
      var childPropsSelector = (0, _react.useMemo)(function () {
        return createChildSelector(store);
      }, [store]);

      var _useMemo2 = (0, _react.useMemo)(function () {
        if (!shouldHandleStateChanges) return NO_SUBSCRIPTION_ARRAY;
        var subscription = new _Subscription["default"](store, didStoreComeFromProps ? null : contextValue.subscription);
        var notifyNestedSubs = subscription.notifyNestedSubs.bind(subscription);
        return [subscription, notifyNestedSubs];
      }, [store, didStoreComeFromProps, contextValue]),
          subscription = _useMemo2[0],
          notifyNestedSubs = _useMemo2[1];

      var overriddenContextValue = (0, _react.useMemo)(function () {
        if (didStoreComeFromProps) {
          return contextValue;
        }

        return (0, _extends2["default"])({}, contextValue, {
          subscription: subscription
        });
      }, [didStoreComeFromProps, contextValue, subscription]);

      var _useReducer = (0, _react.useReducer)(storeStateUpdatesReducer, EMPTY_ARRAY, initStateUpdates),
          _useReducer$ = _useReducer[0],
          previousStateUpdateResult = _useReducer$[0],
          forceComponentUpdateDispatch = _useReducer[1];

      if (previousStateUpdateResult && previousStateUpdateResult.error) {
        throw previousStateUpdateResult.error;
      }

      var lastChildProps = (0, _react.useRef)();
      var lastWrapperProps = (0, _react.useRef)(wrapperProps);
      var childPropsFromStoreUpdate = (0, _react.useRef)();
      var renderIsScheduled = (0, _react.useRef)(false);
      var actualChildProps = usePureOnlyMemo(function () {
        if (childPropsFromStoreUpdate.current && wrapperProps === lastWrapperProps.current) {
          return childPropsFromStoreUpdate.current;
        }

        return childPropsSelector(store.getState(), wrapperProps);
      }, [store, previousStateUpdateResult, wrapperProps]);
      useIsomorphicLayoutEffectWithArgs(captureWrapperProps, [lastWrapperProps, lastChildProps, renderIsScheduled, wrapperProps, actualChildProps, childPropsFromStoreUpdate, notifyNestedSubs]);
      useIsomorphicLayoutEffectWithArgs(subscribeUpdates, [shouldHandleStateChanges, store, subscription, childPropsSelector, lastWrapperProps, lastChildProps, renderIsScheduled, childPropsFromStoreUpdate, notifyNestedSubs, forceComponentUpdateDispatch], [store, subscription, childPropsSelector]);
      var renderedWrappedComponent = (0, _react.useMemo)(function () {
        return _react["default"].createElement(WrappedComponent, (0, _extends2["default"])({}, actualChildProps, {
          ref: reactReduxForwardedRef
        }));
      }, [reactReduxForwardedRef, WrappedComponent, actualChildProps]);
      var renderedChild = (0, _react.useMemo)(function () {
        if (shouldHandleStateChanges) {
          return _react["default"].createElement(ContextToUse.Provider, {
            value: overriddenContextValue
          }, renderedWrappedComponent);
        }

        return renderedWrappedComponent;
      }, [ContextToUse, renderedWrappedComponent, overriddenContextValue]);
      return renderedChild;
    }

    var Connect = pure ? _react["default"].memo(ConnectFunction) : ConnectFunction;
    Connect.WrappedComponent = WrappedComponent;
    Connect.displayName = ConnectFunction.displayName = displayName;

    if (forwardRef) {
      var forwarded = _react["default"].forwardRef(function forwardConnectRef(props, ref) {
        return _react["default"].createElement(Connect, (0, _extends2["default"])({}, props, {
          reactReduxForwardedRef: ref
        }));
      });

      forwarded.displayName = displayName;
      forwarded.WrappedComponent = WrappedComponent;
      return (0, _hoistNonReactStatics["default"])(forwarded, WrappedComponent);
    }

    return (0, _hoistNonReactStatics["default"])(Connect, WrappedComponent);
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbm5lY3RBZHZhbmNlZC5qcyJdLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsInJlcXVpcmUiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiZXhwb3J0cyIsIl9fZXNNb2R1bGUiLCJjb25uZWN0QWR2YW5jZWQiLCJfZXh0ZW5kczIiLCJfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZTIiLCJfaG9pc3ROb25SZWFjdFN0YXRpY3MiLCJfcmVhY3QiLCJfcmVhY3RJcyIsIl9TdWJzY3JpcHRpb24iLCJfdXNlSXNvbW9ycGhpY0xheW91dEVmZmVjdCIsIl9Db250ZXh0IiwiRU1QVFlfQVJSQVkiLCJOT19TVUJTQ1JJUFRJT05fQVJSQVkiLCJzdHJpbmdpZnlDb21wb25lbnQiLCJDb21wIiwiSlNPTiIsInN0cmluZ2lmeSIsImVyciIsIlN0cmluZyIsInN0b3JlU3RhdGVVcGRhdGVzUmVkdWNlciIsInN0YXRlIiwiYWN0aW9uIiwidXBkYXRlQ291bnQiLCJwYXlsb2FkIiwidXNlSXNvbW9ycGhpY0xheW91dEVmZmVjdFdpdGhBcmdzIiwiZWZmZWN0RnVuYyIsImVmZmVjdEFyZ3MiLCJkZXBlbmRlbmNpZXMiLCJ1c2VJc29tb3JwaGljTGF5b3V0RWZmZWN0IiwiYXBwbHkiLCJjYXB0dXJlV3JhcHBlclByb3BzIiwibGFzdFdyYXBwZXJQcm9wcyIsImxhc3RDaGlsZFByb3BzIiwicmVuZGVySXNTY2hlZHVsZWQiLCJ3cmFwcGVyUHJvcHMiLCJhY3R1YWxDaGlsZFByb3BzIiwiY2hpbGRQcm9wc0Zyb21TdG9yZVVwZGF0ZSIsIm5vdGlmeU5lc3RlZFN1YnMiLCJjdXJyZW50Iiwic3Vic2NyaWJlVXBkYXRlcyIsInNob3VsZEhhbmRsZVN0YXRlQ2hhbmdlcyIsInN0b3JlIiwic3Vic2NyaXB0aW9uIiwiY2hpbGRQcm9wc1NlbGVjdG9yIiwiZm9yY2VDb21wb25lbnRVcGRhdGVEaXNwYXRjaCIsImRpZFVuc3Vic2NyaWJlIiwibGFzdFRocm93bkVycm9yIiwiY2hlY2tGb3JVcGRhdGVzIiwibGF0ZXN0U3RvcmVTdGF0ZSIsImdldFN0YXRlIiwibmV3Q2hpbGRQcm9wcyIsImVycm9yIiwiZSIsInR5cGUiLCJvblN0YXRlQ2hhbmdlIiwidHJ5U3Vic2NyaWJlIiwidW5zdWJzY3JpYmVXcmFwcGVyIiwidHJ5VW5zdWJzY3JpYmUiLCJpbml0U3RhdGVVcGRhdGVzIiwic2VsZWN0b3JGYWN0b3J5IiwiX3JlZiIsIl9yZWYyIiwiX3JlZjIkZ2V0RGlzcGxheU5hbWUiLCJnZXREaXNwbGF5TmFtZSIsIm5hbWUiLCJfcmVmMiRtZXRob2ROYW1lIiwibWV0aG9kTmFtZSIsIl9yZWYyJHJlbmRlckNvdW50UHJvcCIsInJlbmRlckNvdW50UHJvcCIsInVuZGVmaW5lZCIsIl9yZWYyJHNob3VsZEhhbmRsZVN0YSIsIl9yZWYyJHN0b3JlS2V5Iiwic3RvcmVLZXkiLCJfcmVmMiR3aXRoUmVmIiwid2l0aFJlZiIsIl9yZWYyJGZvcndhcmRSZWYiLCJmb3J3YXJkUmVmIiwiX3JlZjIkY29udGV4dCIsImNvbnRleHQiLCJSZWFjdFJlZHV4Q29udGV4dCIsImNvbm5lY3RPcHRpb25zIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwiRXJyb3IiLCJjdXN0b21TdG9yZVdhcm5pbmdNZXNzYWdlIiwiQ29udGV4dCIsIndyYXBXaXRoQ29ubmVjdCIsIldyYXBwZWRDb21wb25lbnQiLCJpc1ZhbGlkRWxlbWVudFR5cGUiLCJ3cmFwcGVkQ29tcG9uZW50TmFtZSIsImRpc3BsYXlOYW1lIiwic2VsZWN0b3JGYWN0b3J5T3B0aW9ucyIsInB1cmUiLCJjcmVhdGVDaGlsZFNlbGVjdG9yIiwiZGlzcGF0Y2giLCJ1c2VQdXJlT25seU1lbW8iLCJ1c2VNZW1vIiwiY2FsbGJhY2siLCJDb25uZWN0RnVuY3Rpb24iLCJwcm9wcyIsIl91c2VNZW1vIiwicmVhY3RSZWR1eEZvcndhcmRlZFJlZiIsInByb3BzQ29udGV4dCIsIkNvbnRleHRUb1VzZSIsIkNvbnN1bWVyIiwiaXNDb250ZXh0Q29uc3VtZXIiLCJjcmVhdGVFbGVtZW50IiwiY29udGV4dFZhbHVlIiwidXNlQ29udGV4dCIsImRpZFN0b3JlQ29tZUZyb21Qcm9wcyIsIkJvb2xlYW4iLCJkaWRTdG9yZUNvbWVGcm9tQ29udGV4dCIsIl91c2VNZW1vMiIsImJpbmQiLCJvdmVycmlkZGVuQ29udGV4dFZhbHVlIiwiX3VzZVJlZHVjZXIiLCJ1c2VSZWR1Y2VyIiwiX3VzZVJlZHVjZXIkIiwicHJldmlvdXNTdGF0ZVVwZGF0ZVJlc3VsdCIsInVzZVJlZiIsInJlbmRlcmVkV3JhcHBlZENvbXBvbmVudCIsInJlZiIsInJlbmRlcmVkQ2hpbGQiLCJQcm92aWRlciIsInZhbHVlIiwiQ29ubmVjdCIsIm1lbW8iLCJmb3J3YXJkZWQiLCJmb3J3YXJkQ29ubmVjdFJlZiJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsSUFBSUEsdUJBQXVCLEdBQUdDLE9BQU8sQ0FBQywrQ0FBRCxDQUFyQzs7QUFFQSxJQUFJQyxzQkFBc0IsR0FBR0QsT0FBTyxDQUFDLDhDQUFELENBQXBDOztBQUVBRSxPQUFPLENBQUNDLFVBQVIsR0FBcUIsSUFBckI7QUFDQUQsT0FBTyxDQUFDLFNBQUQsQ0FBUCxHQUFxQkUsZUFBckI7O0FBRUEsSUFBSUMsU0FBUyxHQUFHSixzQkFBc0IsQ0FBQ0QsT0FBTyxDQUFDLGdDQUFELENBQVIsQ0FBdEM7O0FBRUEsSUFBSU0sOEJBQThCLEdBQUdMLHNCQUFzQixDQUFDRCxPQUFPLENBQUMscURBQUQsQ0FBUixDQUEzRDs7QUFFQSxJQUFJTyxxQkFBcUIsR0FBR04sc0JBQXNCLENBQUNELE9BQU8sQ0FBQyx5QkFBRCxDQUFSLENBQWxEOztBQUVBLElBQUlRLE1BQU0sR0FBR1QsdUJBQXVCLENBQUNDLE9BQU8sQ0FBQyxPQUFELENBQVIsQ0FBcEM7O0FBRUEsSUFBSVMsUUFBUSxHQUFHVCxPQUFPLENBQUMsVUFBRCxDQUF0Qjs7QUFFQSxJQUFJVSxhQUFhLEdBQUdULHNCQUFzQixDQUFDRCxPQUFPLHlCQUFSLENBQTFDOztBQUVB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QUVvQjtBQUR3RSxTQUFyQyxDQUF6QyxDQUFwQjtBQUdELE9BSmUsQ0FBaEI7O0FBTUFNLE1BQUFBLFNBQVMsQ0FBQ3JDLFdBQVYsR0FBd0JBLFdBQXhCO0FBQ0FxQyxNQUFBQSxTQUFTLENBQUN4QyxnQkFBVixHQUE2QkEsZ0JBQTdCO0FBQ0EsYUFBTyxDQUFDLEdBQUduRixxQkFBcUIsQ0FBQyxTQUFELENBQXpCLEVBQXNDMkgsU0FBdEMsRUFBaUR4QyxnQkFBakQsQ0FBUDtBQUNEOztBQUVELFdBQU8sQ0FBQyxHQUFHbkYscUJBQXFCLENBQUMsU0FBRCxDQUF6QixFQUFzQ3lILE9BQXRDLEVBQStDdEMsZ0JBQS9DLENBQVA7QUFDRCxHQXJMRDtBQXNMRCIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkXCIpO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gY29ubmVjdEFkdmFuY2VkO1xuXG52YXIgX2V4dGVuZHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9leHRlbmRzXCIpKTtcblxudmFyIF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZVwiKSk7XG5cbnZhciBfaG9pc3ROb25SZWFjdFN0YXRpY3MgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJob2lzdC1ub24tcmVhY3Qtc3RhdGljc1wiKSk7XG5cbnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKFwicmVhY3RcIikpO1xuXG52YXIgX3JlYWN0SXMgPSByZXF1aXJlKFwicmVhY3QtaXNcIik7XG5cbnZhciBfU3Vic2NyaXB0aW9uID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vdXRpbHMvU3Vic2NyaXB0aW9uXCIpKTtcblxudmFyIF91c2VJc29tb3JwaGljTGF5b3V0RWZmZWN0ID0gcmVxdWlyZShcIi4uL3V0aWxzL3VzZUlzb21vcnBoaWNMYXlvdXRFZmZlY3RcIik7XG5cbnZhciBfQ29udGV4dCA9IHJlcXVpcmUoXCIuL0NvbnRleHRcIik7XG5cbi8vIERlZmluZSBzb21lIGNvbnN0YW50IGFycmF5cyBqdXN0IHRvIGF2b2lkIHJlLWNyZWF0aW5nIHRoZXNlXG52YXIgRU1QVFlfQVJSQVkgPSBbXTtcbnZhciBOT19TVUJTQ1JJUFRJT05fQVJSQVkgPSBbbnVsbCwgbnVsbF07XG5cbnZhciBzdHJpbmdpZnlDb21wb25lbnQgPSBmdW5jdGlvbiBzdHJpbmdpZnlDb21wb25lbnQoQ29tcCkge1xuICB0cnkge1xuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShDb21wKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgcmV0dXJuIFN0cmluZyhDb21wKTtcbiAgfVxufTtcblxuZnVuY3Rpb24gc3RvcmVTdGF0ZVVwZGF0ZXNSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pIHtcbiAgdmFyIHVwZGF0ZUNvdW50ID0gc3RhdGVbMV07XG4gIHJldHVybiBbYWN0aW9uLnBheWxvYWQsIHVwZGF0ZUNvdW50ICsgMV07XG59XG5cbmZ1bmN0aW9uIHVzZUlzb21vcnBoaWNMYXlvdXRFZmZlY3RXaXRoQXJncyhlZmZlY3RGdW5jLCBlZmZlY3RBcmdzLCBkZXBlbmRlbmNpZXMpIHtcbiAgKDAsIF91c2VJc29tb3JwaGljTGF5b3V0RWZmZWN0LnVzZUlzb21vcnBoaWNMYXlvdXRFZmZlY3QpKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZWZmZWN0RnVuYy5hcHBseSh2b2lkIDAsIGVmZmVjdEFyZ3MpO1xuICB9LCBkZXBlbmRlbmNpZXMpO1xufVxuXG5mdW5jdGlvbiBjYXB0dXJlV3JhcHBlclByb3BzKGxhc3RXcmFwcGVyUHJvcHMsIGxhc3RDaGlsZFByb3BzLCByZW5kZXJJc1NjaGVkdWxlZCwgd3JhcHBlclByb3BzLCBhY3R1YWxDaGlsZFByb3BzLCBjaGlsZFByb3BzRnJvbVN0b3JlVXBkYXRlLCBub3RpZnlOZXN0ZWRTdWJzKSB7XG4gIC8vIFdlIHdhbnQgdG8gY2FwdHVyZSB0aGUgd3JhcHBlciBwcm9wcyBhbmQgY2hpbGQgcHJvcHMgd2UgdXNlZCBmb3IgbGF0ZXIgY29tcGFyaXNvbnNcbiAgbGFzdFdyYXBwZXJQcm9wcy5jdXJyZW50ID0gd3JhcHBlclByb3BzO1xuICBsYXN0Q2hpbGRQcm9wcy5jdXJyZW50ID0gYWN0dWFsQ2hpbGRQcm9wcztcbiAgcmVuZGVySXNTY2hlZHVsZWQuY3VycmVudCA9IGZhbHNlOyAvLyBJZiB0aGUgcmVuZGVyIHdhcyBmcm9tIGEgc3RvcmUgdXBkYXRlLCBjbGVhciBvdXQgdGhhdCByZWZlcmVuY2UgYW5kIGNhc2NhZGUgdGhlIHN1YnNjcmliZXIgdXBkYXRlXG5cbiAgaWYgKGNoaWxkUHJvcHNGcm9tU3RvcmVVcGRhdGUuY3VycmVudCkge1xuICAgIGNoaWxkUHJvcHNGcm9tU3RvcmVVcGRhdGUuY3VycmVudCA9IG51bGw7XG4gICAgbm90aWZ5TmVzdGVkU3VicygpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHN1YnNjcmliZVVwZGF0ZXMoc2hvdWxkSGFuZGxlU3RhdGVDaGFuZ2VzLCBzdG9yZSwgc3Vic2NyaXB0aW9uLCBjaGlsZFByb3BzU2VsZWN0b3IsIGxhc3RXcmFwcGVyUHJvcHMsIGxhc3RDaGlsZFByb3BzLCByZW5kZXJJc1NjaGVkdWxlZCwgY2hpbGRQcm9wc0Zyb21TdG9yZVVwZGF0ZSwgbm90aWZ5TmVzdGVkU3VicywgZm9yY2VDb21wb25lbnRVcGRhdGVEaXNwYXRjaCkge1xuICAvLyBJZiB3ZSdyZSBub3Qgc3Vic2NyaWJlZCB0byB0aGUgc3RvcmUsIG5vdGhpbmcgdG8gZG8gaGVyZVxuICBpZiAoIXNob3VsZEhhbmRsZVN0YXRlQ2hhbmdlcykgcmV0dXJuOyAvLyBDYXB0dXJlIHZhbHVlcyBmb3IgY2hlY2tpbmcgaWYgYW5kIHdoZW4gdGhpcyBjb21wb25lbnQgdW5tb3VudHNcblxuICB2YXIgZGlkVW5zdWJzY3JpYmUgPSBmYWxzZTtcbiAgdmFyIGxhc3RUaHJvd25FcnJvciA9IG51bGw7IC8vIFdlJ2xsIHJ1biB0aGlzIGNhbGxiYWNrIGV2ZXJ5IHRpbWUgYSBzdG9yZSBzdWJzY3JpcHRpb24gdXBkYXRlIHByb3BhZ2F0ZXMgdG8gdGhpcyBjb21wb25lbnRcblxuICB2YXIgY2hlY2tGb3JVcGRhdGVzID0gZnVuY3Rpb24gY2hlY2tGb3JVcGRhdGVzKCkge1xuICAgIGlmIChkaWRVbnN1YnNjcmliZSkge1xuICAgICAgLy8gRG9uJ3QgcnVuIHN0YWxlIGxpc3RlbmVycy5cbiAgICAgIC8vIFJlZHV4IGRvZXNuJ3QgZ3VhcmFudGVlIHVuc3Vic2NyaXB0aW9ucyBoYXBwZW4gdW50aWwgbmV4dCBkaXNwYXRjaC5cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgbGF0ZXN0U3RvcmVTdGF0ZSA9IHN0b3JlLmdldFN0YXRlKCk7XG4gICAgdmFyIG5ld0NoaWxkUHJvcHMsIGVycm9yO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIEFjdHVhbGx5IHJ1biB0aGUgc2VsZWN0b3Igd2l0aCB0aGUgbW9zdCByZWNlbnQgc3RvcmUgc3RhdGUgYW5kIHdyYXBwZXIgcHJvcHNcbiAgICAgIC8vIHRvIGRldGVybWluZSB3aGF0IHRoZSBjaGlsZCBwcm9wcyBzaG91bGQgYmVcbiAgICAgIG5ld0NoaWxkUHJvcHMgPSBjaGlsZFByb3BzU2VsZWN0b3IobGF0ZXN0U3RvcmVTdGF0ZSwgbGFzdFdyYXBwZXJQcm9wcy5jdXJyZW50KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBlcnJvciA9IGU7XG4gICAgICBsYXN0VGhyb3duRXJyb3IgPSBlO1xuICAgIH1cblxuICAgIGlmICghZXJyb3IpIHtcbiAgICAgIGxhc3RUaHJvd25FcnJvciA9IG51bGw7XG4gICAgfSAvLyBJZiB0aGUgY2hpbGQgcHJvcHMgaGF2ZW4ndCBjaGFuZ2VkLCBub3RoaW5nIHRvIGRvIGhlcmUgLSBjYXNjYWRlIHRoZSBzdWJzY3JpcHRpb24gdXBkYXRlXG5cblxuICAgIGlmIChuZXdDaGlsZFByb3BzID09PSBsYXN0Q2hpbGRQcm9wcy5jdXJyZW50KSB7XG4gICAgICBpZiAoIXJlbmRlcklzU2NoZWR1bGVkLmN1cnJlbnQpIHtcbiAgICAgICAgbm90aWZ5TmVzdGVkU3VicygpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBTYXZlIHJlZmVyZW5jZXMgdG8gdGhlIG5ldyBjaGlsZCBwcm9wcy4gIE5vdGUgdGhhdCB3ZSB0cmFjayB0aGUgXCJjaGlsZCBwcm9wcyBmcm9tIHN0b3JlIHVwZGF0ZVwiXG4gICAgICAvLyBhcyBhIHJlZiBpbnN0ZWFkIG9mIGEgdXNlU3RhdGUvdXNlUmVkdWNlciBiZWNhdXNlIHdlIG5lZWQgYSB3YXkgdG8gZGV0ZXJtaW5lIGlmIHRoYXQgdmFsdWUgaGFzXG4gICAgICAvLyBiZWVuIHByb2Nlc3NlZC4gIElmIHRoaXMgd2VudCBpbnRvIHVzZVN0YXRlL3VzZVJlZHVjZXIsIHdlIGNvdWxkbid0IGNsZWFyIG91dCB0aGUgdmFsdWUgd2l0aG91dFxuICAgICAgLy8gZm9yY2luZyBhbm90aGVyIHJlLXJlbmRlciwgd2hpY2ggd2UgZG9uJ3Qgd2FudC5cbiAgICAgIGxhc3RDaGlsZFByb3BzLmN1cnJlbnQgPSBuZXdDaGlsZFByb3BzO1xuICAgICAgY2hpbGRQcm9wc0Zyb21TdG9yZVVwZGF0ZS5jdXJyZW50ID0gbmV3Q2hpbGRQcm9wcztcbiAgICAgIHJlbmRlcklzU2NoZWR1bGVkLmN1cnJlbnQgPSB0cnVlOyAvLyBJZiB0aGUgY2hpbGQgcHJvcHMgX2RpZF8gY2hhbmdlIChvciB3ZSBjYXVnaHQgYW4gZXJyb3IpLCB0aGlzIHdyYXBwZXIgY29tcG9uZW50IG5lZWRzIHRvIHJlLXJlbmRlclxuXG4gICAgICBmb3JjZUNvbXBvbmVudFVwZGF0ZURpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogJ1NUT1JFX1VQREFURUQnLFxuICAgICAgICBwYXlsb2FkOiB7XG4gICAgICAgICAgZXJyb3I6IGVycm9yXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfTsgLy8gQWN0dWFsbHkgc3Vic2NyaWJlIHRvIHRoZSBuZWFyZXN0IGNvbm5lY3RlZCBhbmNlc3RvciAob3Igc3RvcmUpXG5cblxuICBzdWJzY3JpcHRpb24ub25TdGF0ZUNoYW5nZSA9IGNoZWNrRm9yVXBkYXRlcztcbiAgc3Vic2NyaXB0aW9uLnRyeVN1YnNjcmliZSgpOyAvLyBQdWxsIGRhdGEgZnJvbSB0aGUgc3RvcmUgYWZ0ZXIgZmlyc3QgcmVuZGVyIGluIGNhc2UgdGhlIHN0b3JlIGhhc1xuICAvLyBjaGFuZ2VkIHNpbmNlIHdlIGJlZ2FuLlxuXG4gIGNoZWNrRm9yVXBkYXRlcygpO1xuXG4gIHZhciB1bnN1YnNjcmliZVdyYXBwZXIgPSBmdW5jdGlvbiB1bnN1YnNjcmliZVdyYXBwZXIoKSB7XG4gICAgZGlkVW5zdWJzY3JpYmUgPSB0cnVlO1xuICAgIHN1YnNjcmlwdGlvbi50cnlVbnN1YnNjcmliZSgpO1xuICAgIHN1YnNjcmlwdGlvbi5vblN0YXRlQ2hhbmdlID0gbnVsbDtcblxuICAgIGlmIChsYXN0VGhyb3duRXJyb3IpIHtcbiAgICAgIC8vIEl0J3MgcG9zc2libGUgdGhhdCB3ZSBjYXVnaHQgYW4gZXJyb3IgZHVlIHRvIGEgYmFkIG1hcFN0YXRlIGZ1bmN0aW9uLCBidXQgdGhlXG4gICAgICAvLyBwYXJlbnQgcmUtcmVuZGVyZWQgd2l0aG91dCB0aGlzIGNvbXBvbmVudCBhbmQgd2UncmUgYWJvdXQgdG8gdW5tb3VudC5cbiAgICAgIC8vIFRoaXMgc2hvdWxkbid0IGhhcHBlbiBhcyBsb25nIGFzIHdlIGRvIHRvcC1kb3duIHN1YnNjcmlwdGlvbnMgY29ycmVjdGx5LCBidXRcbiAgICAgIC8vIGlmIHdlIGV2ZXIgZG8gdGhvc2Ugd3JvbmcsIHRoaXMgdGhyb3cgd2lsbCBzdXJmYWNlIHRoZSBlcnJvciBpbiBvdXIgdGVzdHMuXG4gICAgICAvLyBJbiB0aGF0IGNhc2UsIHRocm93IHRoZSBlcnJvciBmcm9tIGhlcmUgc28gaXQgZG9lc24ndCBnZXQgbG9zdC5cbiAgICAgIHRocm93IGxhc3RUaHJvd25FcnJvcjtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIHVuc3Vic2NyaWJlV3JhcHBlcjtcbn1cblxudmFyIGluaXRTdGF0ZVVwZGF0ZXMgPSBmdW5jdGlvbiBpbml0U3RhdGVVcGRhdGVzKCkge1xuICByZXR1cm4gW251bGwsIDBdO1xufTtcblxuZnVuY3Rpb24gY29ubmVjdEFkdmFuY2VkKFxuLypcclxuICBzZWxlY3RvckZhY3RvcnkgaXMgYSBmdW5jIHRoYXQgaXMgcmVzcG9uc2libGUgZm9yIHJldHVybmluZyB0aGUgc2VsZWN0b3IgZnVuY3Rpb24gdXNlZCB0b1xyXG4gIGNvbXB1dGUgbmV3IHByb3BzIGZyb20gc3RhdGUsIHByb3BzLCBhbmQgZGlzcGF0Y2guIEZvciBleGFtcGxlOlxyXG4gICAgICBleHBvcnQgZGVmYXVsdCBjb25uZWN0QWR2YW5jZWQoKGRpc3BhdGNoLCBvcHRpb25zKSA9PiAoc3RhdGUsIHByb3BzKSA9PiAoe1xyXG4gICAgICB0aGluZzogc3RhdGUudGhpbmdzW3Byb3BzLnRoaW5nSWRdLFxyXG4gICAgICBzYXZlVGhpbmc6IGZpZWxkcyA9PiBkaXNwYXRjaChhY3Rpb25DcmVhdG9ycy5zYXZlVGhpbmcocHJvcHMudGhpbmdJZCwgZmllbGRzKSksXHJcbiAgICB9KSkoWW91ckNvbXBvbmVudClcclxuICAgIEFjY2VzcyB0byBkaXNwYXRjaCBpcyBwcm92aWRlZCB0byB0aGUgZmFjdG9yeSBzbyBzZWxlY3RvckZhY3RvcmllcyBjYW4gYmluZCBhY3Rpb25DcmVhdG9yc1xyXG4gIG91dHNpZGUgb2YgdGhlaXIgc2VsZWN0b3IgYXMgYW4gb3B0aW1pemF0aW9uLiBPcHRpb25zIHBhc3NlZCB0byBjb25uZWN0QWR2YW5jZWQgYXJlIHBhc3NlZCB0b1xyXG4gIHRoZSBzZWxlY3RvckZhY3RvcnksIGFsb25nIHdpdGggZGlzcGxheU5hbWUgYW5kIFdyYXBwZWRDb21wb25lbnQsIGFzIHRoZSBzZWNvbmQgYXJndW1lbnQuXHJcbiAgICBOb3RlIHRoYXQgc2VsZWN0b3JGYWN0b3J5IGlzIHJlc3BvbnNpYmxlIGZvciBhbGwgY2FjaGluZy9tZW1vaXphdGlvbiBvZiBpbmJvdW5kIGFuZCBvdXRib3VuZFxyXG4gIHByb3BzLiBEbyBub3QgdXNlIGNvbm5lY3RBZHZhbmNlZCBkaXJlY3RseSB3aXRob3V0IG1lbW9pemluZyByZXN1bHRzIGJldHdlZW4gY2FsbHMgdG8geW91clxyXG4gIHNlbGVjdG9yLCBvdGhlcndpc2UgdGhlIENvbm5lY3QgY29tcG9uZW50IHdpbGwgcmUtcmVuZGVyIG9uIGV2ZXJ5IHN0YXRlIG9yIHByb3BzIGNoYW5nZS5cclxuKi9cbnNlbGVjdG9yRmFjdG9yeSwgLy8gb3B0aW9ucyBvYmplY3Q6XG5fcmVmKSB7XG4gIGlmIChfcmVmID09PSB2b2lkIDApIHtcbiAgICBfcmVmID0ge307XG4gIH1cblxuICB2YXIgX3JlZjIgPSBfcmVmLFxuICAgICAgX3JlZjIkZ2V0RGlzcGxheU5hbWUgPSBfcmVmMi5nZXREaXNwbGF5TmFtZSxcbiAgICAgIGdldERpc3BsYXlOYW1lID0gX3JlZjIkZ2V0RGlzcGxheU5hbWUgPT09IHZvaWQgMCA/IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgcmV0dXJuIFwiQ29ubmVjdEFkdmFuY2VkKFwiICsgbmFtZSArIFwiKVwiO1xuICB9IDogX3JlZjIkZ2V0RGlzcGxheU5hbWUsXG4gICAgICBfcmVmMiRtZXRob2ROYW1lID0gX3JlZjIubWV0aG9kTmFtZSxcbiAgICAgIG1ldGhvZE5hbWUgPSBfcmVmMiRtZXRob2ROYW1lID09PSB2b2lkIDAgPyAnY29ubmVjdEFkdmFuY2VkJyA6IF9yZWYyJG1ldGhvZE5hbWUsXG4gICAgICBfcmVmMiRyZW5kZXJDb3VudFByb3AgPSBfcmVmMi5yZW5kZXJDb3VudFByb3AsXG4gICAgICByZW5kZXJDb3VudFByb3AgPSBfcmVmMiRyZW5kZXJDb3VudFByb3AgPT09IHZvaWQgMCA/IHVuZGVmaW5lZCA6IF9yZWYyJHJlbmRlckNvdW50UHJvcCxcbiAgICAgIF9yZWYyJHNob3VsZEhhbmRsZVN0YSA9IF9yZWYyLnNob3VsZEhhbmRsZVN0YXRlQ2hhbmdlcyxcbiAgICAgIHNob3VsZEhhbmRsZVN0YXRlQ2hhbmdlcyA9IF9yZWYyJHNob3VsZEhhbmRsZVN0YSA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9yZWYyJHNob3VsZEhhbmRsZVN0YSxcbiAgICAgIF9yZWYyJHN0b3JlS2V5ID0gX3JlZjIuc3RvcmVLZXksXG4gICAgICBzdG9yZUtleSA9IF9yZWYyJHN0b3JlS2V5ID09PSB2b2lkIDAgPyAnc3RvcmUnIDogX3JlZjIkc3RvcmVLZXksXG4gICAgICBfcmVmMiR3aXRoUmVmID0gX3JlZjIud2l0aFJlZixcbiAgICAgIHdpdGhSZWYgPSBfcmVmMiR3aXRoUmVmID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWYyJHdpdGhSZWYsXG4gICAgICBfcmVmMiRmb3J3YXJkUmVmID0gX3JlZjIuZm9yd2FyZFJlZixcbiAgICAgIGZvcndhcmRSZWYgPSBfcmVmMiRmb3J3YXJkUmVmID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWYyJGZvcndhcmRSZWYsXG4gICAgICBfcmVmMiRjb250ZXh0ID0gX3JlZjIuY29udGV4dCxcbiAgICAgIGNvbnRleHQgPSBfcmVmMiRjb250ZXh0ID09PSB2b2lkIDAgPyBfQ29udGV4dC5SZWFjdFJlZHV4Q29udGV4dCA6IF9yZWYyJGNvbnRleHQsXG4gICAgICBjb25uZWN0T3B0aW9ucyA9ICgwLCBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZTJbXCJkZWZhdWx0XCJdKShfcmVmMiwgW1wiZ2V0RGlzcGxheU5hbWVcIiwgXCJtZXRob2ROYW1lXCIsIFwicmVuZGVyQ291bnRQcm9wXCIsIFwic2hvdWxkSGFuZGxlU3RhdGVDaGFuZ2VzXCIsIFwic3RvcmVLZXlcIiwgXCJ3aXRoUmVmXCIsIFwiZm9yd2FyZFJlZlwiLCBcImNvbnRleHRcIl0pO1xuXG4gIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgaWYgKHJlbmRlckNvdW50UHJvcCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJyZW5kZXJDb3VudFByb3AgaXMgcmVtb3ZlZC4gcmVuZGVyIGNvdW50aW5nIGlzIGJ1aWx0IGludG8gdGhlIGxhdGVzdCBSZWFjdCBEZXYgVG9vbHMgcHJvZmlsaW5nIGV4dGVuc2lvblwiKTtcbiAgICB9XG5cbiAgICBpZiAod2l0aFJlZikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCd3aXRoUmVmIGlzIHJlbW92ZWQuIFRvIGFjY2VzcyB0aGUgd3JhcHBlZCBpbnN0YW5jZSwgdXNlIGEgcmVmIG9uIHRoZSBjb25uZWN0ZWQgY29tcG9uZW50Jyk7XG4gICAgfVxuXG4gICAgdmFyIGN1c3RvbVN0b3JlV2FybmluZ01lc3NhZ2UgPSAnVG8gdXNlIGEgY3VzdG9tIFJlZHV4IHN0b3JlIGZvciBzcGVjaWZpYyBjb21wb25lbnRzLCBjcmVhdGUgYSBjdXN0b20gUmVhY3QgY29udGV4dCB3aXRoICcgKyBcIlJlYWN0LmNyZWF0ZUNvbnRleHQoKSwgYW5kIHBhc3MgdGhlIGNvbnRleHQgb2JqZWN0IHRvIFJlYWN0IFJlZHV4J3MgUHJvdmlkZXIgYW5kIHNwZWNpZmljIGNvbXBvbmVudHNcIiArICcgbGlrZTogPFByb3ZpZGVyIGNvbnRleHQ9e015Q29udGV4dH0+PENvbm5lY3RlZENvbXBvbmVudCBjb250ZXh0PXtNeUNvbnRleHR9IC8+PC9Qcm92aWRlcj4uICcgKyAnWW91IG1heSBhbHNvIHBhc3MgYSB7Y29udGV4dCA6IE15Q29udGV4dH0gb3B0aW9uIHRvIGNvbm5lY3QnO1xuXG4gICAgaWYgKHN0b3JlS2V5ICE9PSAnc3RvcmUnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ3N0b3JlS2V5IGhhcyBiZWVuIHJlbW92ZWQgYW5kIGRvZXMgbm90IGRvIGFueXRoaW5nLiAnICsgY3VzdG9tU3RvcmVXYXJuaW5nTWVzc2FnZSk7XG4gICAgfVxuICB9XG5cbiAgdmFyIENvbnRleHQgPSBjb250ZXh0O1xuICByZXR1cm4gZnVuY3Rpb24gd3JhcFdpdGhDb25uZWN0KFdyYXBwZWRDb21wb25lbnQpIHtcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiAhKDAsIF9yZWFjdElzLmlzVmFsaWRFbGVtZW50VHlwZSkoV3JhcHBlZENvbXBvbmVudCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIllvdSBtdXN0IHBhc3MgYSBjb21wb25lbnQgdG8gdGhlIGZ1bmN0aW9uIHJldHVybmVkIGJ5IFwiICsgKG1ldGhvZE5hbWUgKyBcIi4gSW5zdGVhZCByZWNlaXZlZCBcIiArIHN0cmluZ2lmeUNvbXBvbmVudChXcmFwcGVkQ29tcG9uZW50KSkpO1xuICAgIH1cblxuICAgIHZhciB3cmFwcGVkQ29tcG9uZW50TmFtZSA9IFdyYXBwZWRDb21wb25lbnQuZGlzcGxheU5hbWUgfHwgV3JhcHBlZENvbXBvbmVudC5uYW1lIHx8ICdDb21wb25lbnQnO1xuICAgIHZhciBkaXNwbGF5TmFtZSA9IGdldERpc3BsYXlOYW1lKHdyYXBwZWRDb21wb25lbnROYW1lKTtcbiAgICB2YXIgc2VsZWN0b3JGYWN0b3J5T3B0aW9ucyA9ICgwLCBfZXh0ZW5kczJbXCJkZWZhdWx0XCJdKSh7fSwgY29ubmVjdE9wdGlvbnMsIHtcbiAgICAgIGdldERpc3BsYXlOYW1lOiBnZXREaXNwbGF5TmFtZSxcbiAgICAgIG1ldGhvZE5hbWU6IG1ldGhvZE5hbWUsXG4gICAgICByZW5kZXJDb3VudFByb3A6IHJlbmRlckNvdW50UHJvcCxcbiAgICAgIHNob3VsZEhhbmRsZVN0YXRlQ2hhbmdlczogc2hvdWxkSGFuZGxlU3RhdGVDaGFuZ2VzLFxuICAgICAgc3RvcmVLZXk6IHN0b3JlS2V5LFxuICAgICAgZGlzcGxheU5hbWU6IGRpc3BsYXlOYW1lLFxuICAgICAgd3JhcHBlZENvbXBvbmVudE5hbWU6IHdyYXBwZWRDb21wb25lbnROYW1lLFxuICAgICAgV3JhcHBlZENvbXBvbmVudDogV3JhcHBlZENvbXBvbmVudFxuICAgIH0pO1xuICAgIHZhciBwdXJlID0gY29ubmVjdE9wdGlvbnMucHVyZTtcblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUNoaWxkU2VsZWN0b3Ioc3RvcmUpIHtcbiAgICAgIHJldHVybiBzZWxlY3RvckZhY3Rvcnkoc3RvcmUuZGlzcGF0Y2gsIHNlbGVjdG9yRmFjdG9yeU9wdGlvbnMpO1xuICAgIH0gLy8gSWYgd2UgYXJlbid0IHJ1bm5pbmcgaW4gXCJwdXJlXCIgbW9kZSwgd2UgZG9uJ3Qgd2FudCB0byBtZW1vaXplIHZhbHVlcy5cbiAgICAvLyBUbyBhdm9pZCBjb25kaXRpb25hbGx5IGNhbGxpbmcgaG9va3MsIHdlIGZhbGwgYmFjayB0byBhIHRpbnkgd3JhcHBlclxuICAgIC8vIHRoYXQganVzdCBleGVjdXRlcyB0aGUgZ2l2ZW4gY2FsbGJhY2sgaW1tZWRpYXRlbHkuXG5cblxuICAgIHZhciB1c2VQdXJlT25seU1lbW8gPSBwdXJlID8gX3JlYWN0LnVzZU1lbW8gOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgIHJldHVybiBjYWxsYmFjaygpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBDb25uZWN0RnVuY3Rpb24ocHJvcHMpIHtcbiAgICAgIHZhciBfdXNlTWVtbyA9ICgwLCBfcmVhY3QudXNlTWVtbykoZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBEaXN0aW5ndWlzaCBiZXR3ZWVuIGFjdHVhbCBcImRhdGFcIiBwcm9wcyB0aGF0IHdlcmUgcGFzc2VkIHRvIHRoZSB3cmFwcGVyIGNvbXBvbmVudCxcbiAgICAgICAgLy8gYW5kIHZhbHVlcyBuZWVkZWQgdG8gY29udHJvbCBiZWhhdmlvciAoZm9yd2FyZGVkIHJlZnMsIGFsdGVybmF0ZSBjb250ZXh0IGluc3RhbmNlcykuXG4gICAgICAgIC8vIFRvIG1haW50YWluIHRoZSB3cmFwcGVyUHJvcHMgb2JqZWN0IHJlZmVyZW5jZSwgbWVtb2l6ZSB0aGlzIGRlc3RydWN0dXJpbmcuXG4gICAgICAgIHZhciByZWFjdFJlZHV4Rm9yd2FyZGVkUmVmID0gcHJvcHMucmVhY3RSZWR1eEZvcndhcmRlZFJlZixcbiAgICAgICAgICAgIHdyYXBwZXJQcm9wcyA9ICgwLCBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZTJbXCJkZWZhdWx0XCJdKShwcm9wcywgW1wicmVhY3RSZWR1eEZvcndhcmRlZFJlZlwiXSk7XG4gICAgICAgIHJldHVybiBbcHJvcHMuY29udGV4dCwgcmVhY3RSZWR1eEZvcndhcmRlZFJlZiwgd3JhcHBlclByb3BzXTtcbiAgICAgIH0sIFtwcm9wc10pLFxuICAgICAgICAgIHByb3BzQ29udGV4dCA9IF91c2VNZW1vWzBdLFxuICAgICAgICAgIHJlYWN0UmVkdXhGb3J3YXJkZWRSZWYgPSBfdXNlTWVtb1sxXSxcbiAgICAgICAgICB3cmFwcGVyUHJvcHMgPSBfdXNlTWVtb1syXTtcblxuICAgICAgdmFyIENvbnRleHRUb1VzZSA9ICgwLCBfcmVhY3QudXNlTWVtbykoZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBVc2VycyBtYXkgb3B0aW9uYWxseSBwYXNzIGluIGEgY3VzdG9tIGNvbnRleHQgaW5zdGFuY2UgdG8gdXNlIGluc3RlYWQgb2Ygb3VyIFJlYWN0UmVkdXhDb250ZXh0LlxuICAgICAgICAvLyBNZW1vaXplIHRoZSBjaGVjayB0aGF0IGRldGVybWluZXMgd2hpY2ggY29udGV4dCBpbnN0YW5jZSB3ZSBzaG91bGQgdXNlLlxuICAgICAgICByZXR1cm4gcHJvcHNDb250ZXh0ICYmIHByb3BzQ29udGV4dC5Db25zdW1lciAmJiAoMCwgX3JlYWN0SXMuaXNDb250ZXh0Q29uc3VtZXIpKCAvKiNfX1BVUkVfXyovX3JlYWN0W1wiZGVmYXVsdFwiXS5jcmVhdGVFbGVtZW50KHByb3BzQ29udGV4dC5Db25zdW1lciwgbnVsbCkpID8gcHJvcHNDb250ZXh0IDogQ29udGV4dDtcbiAgICAgIH0sIFtwcm9wc0NvbnRleHQsIENvbnRleHRdKTsgLy8gUmV0cmlldmUgdGhlIHN0b3JlIGFuZCBhbmNlc3RvciBzdWJzY3JpcHRpb24gdmlhIGNvbnRleHQsIGlmIGF2YWlsYWJsZVxuXG4gICAgICB2YXIgY29udGV4dFZhbHVlID0gKDAsIF9yZWFjdC51c2VDb250ZXh0KShDb250ZXh0VG9Vc2UpOyAvLyBUaGUgc3RvcmUgX211c3RfIGV4aXN0IGFzIGVpdGhlciBhIHByb3Agb3IgaW4gY29udGV4dC5cbiAgICAgIC8vIFdlJ2xsIGNoZWNrIHRvIHNlZSBpZiBpdCBfbG9va3NfIGxpa2UgYSBSZWR1eCBzdG9yZSBmaXJzdC5cbiAgICAgIC8vIFRoaXMgYWxsb3dzIHVzIHRvIHBhc3MgdGhyb3VnaCBhIGBzdG9yZWAgcHJvcCB0aGF0IGlzIGp1c3QgYSBwbGFpbiB2YWx1ZS5cblxuICAgICAgdmFyIGRpZFN0b3JlQ29tZUZyb21Qcm9wcyA9IEJvb2xlYW4ocHJvcHMuc3RvcmUpICYmIEJvb2xlYW4ocHJvcHMuc3RvcmUuZ2V0U3RhdGUpICYmIEJvb2xlYW4ocHJvcHMuc3RvcmUuZGlzcGF0Y2gpO1xuICAgICAgdmFyIGRpZFN0b3JlQ29tZUZyb21Db250ZXh0ID0gQm9vbGVhbihjb250ZXh0VmFsdWUpICYmIEJvb2xlYW4oY29udGV4dFZhbHVlLnN0b3JlKTtcblxuICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgIWRpZFN0b3JlQ29tZUZyb21Qcm9wcyAmJiAhZGlkU3RvcmVDb21lRnJvbUNvbnRleHQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ291bGQgbm90IGZpbmQgXFxcInN0b3JlXFxcIiBpbiB0aGUgY29udGV4dCBvZiBcIiArIChcIlxcXCJcIiArIGRpc3BsYXlOYW1lICsgXCJcXFwiLiBFaXRoZXIgd3JhcCB0aGUgcm9vdCBjb21wb25lbnQgaW4gYSA8UHJvdmlkZXI+LCBcIikgKyBcIm9yIHBhc3MgYSBjdXN0b20gUmVhY3QgY29udGV4dCBwcm92aWRlciB0byA8UHJvdmlkZXI+IGFuZCB0aGUgY29ycmVzcG9uZGluZyBcIiArIChcIlJlYWN0IGNvbnRleHQgY29uc3VtZXIgdG8gXCIgKyBkaXNwbGF5TmFtZSArIFwiIGluIGNvbm5lY3Qgb3B0aW9ucy5cIikpO1xuICAgICAgfSAvLyBCYXNlZCBvbiB0aGUgcHJldmlvdXMgY2hlY2ssIG9uZSBvZiB0aGVzZSBtdXN0IGJlIHRydWVcblxuXG4gICAgICB2YXIgc3RvcmUgPSBkaWRTdG9yZUNvbWVGcm9tUHJvcHMgPyBwcm9wcy5zdG9yZSA6IGNvbnRleHRWYWx1ZS5zdG9yZTtcbiAgICAgIHZhciBjaGlsZFByb3BzU2VsZWN0b3IgPSAoMCwgX3JlYWN0LnVzZU1lbW8pKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gVGhlIGNoaWxkIHByb3BzIHNlbGVjdG9yIG5lZWRzIHRoZSBzdG9yZSByZWZlcmVuY2UgYXMgYW4gaW5wdXQuXG4gICAgICAgIC8vIFJlLWNyZWF0ZSB0aGlzIHNlbGVjdG9yIHdoZW5ldmVyIHRoZSBzdG9yZSBjaGFuZ2VzLlxuICAgICAgICByZXR1cm4gY3JlYXRlQ2hpbGRTZWxlY3RvcihzdG9yZSk7XG4gICAgICB9LCBbc3RvcmVdKTtcblxuICAgICAgdmFyIF91c2VNZW1vMiA9ICgwLCBfcmVhY3QudXNlTWVtbykoZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXNob3VsZEhhbmRsZVN0YXRlQ2hhbmdlcykgcmV0dXJuIE5PX1NVQlNDUklQVElPTl9BUlJBWTsgLy8gVGhpcyBTdWJzY3JpcHRpb24ncyBzb3VyY2Ugc2hvdWxkIG1hdGNoIHdoZXJlIHN0b3JlIGNhbWUgZnJvbTogcHJvcHMgdnMuIGNvbnRleHQuIEEgY29tcG9uZW50XG4gICAgICAgIC8vIGNvbm5lY3RlZCB0byB0aGUgc3RvcmUgdmlhIHByb3BzIHNob3VsZG4ndCB1c2Ugc3Vic2NyaXB0aW9uIGZyb20gY29udGV4dCwgb3IgdmljZSB2ZXJzYS5cblxuICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0gbmV3IF9TdWJzY3JpcHRpb25bXCJkZWZhdWx0XCJdKHN0b3JlLCBkaWRTdG9yZUNvbWVGcm9tUHJvcHMgPyBudWxsIDogY29udGV4dFZhbHVlLnN1YnNjcmlwdGlvbik7IC8vIGBub3RpZnlOZXN0ZWRTdWJzYCBpcyBkdXBsaWNhdGVkIHRvIGhhbmRsZSB0aGUgY2FzZSB3aGVyZSB0aGUgY29tcG9uZW50IGlzIHVubW91bnRlZCBpblxuICAgICAgICAvLyB0aGUgbWlkZGxlIG9mIHRoZSBub3RpZmljYXRpb24gbG9vcCwgd2hlcmUgYHN1YnNjcmlwdGlvbmAgd2lsbCB0aGVuIGJlIG51bGwuIFRoaXMgY2FuXG4gICAgICAgIC8vIHByb2JhYmx5IGJlIGF2b2lkZWQgaWYgU3Vic2NyaXB0aW9uJ3MgbGlzdGVuZXJzIGxvZ2ljIGlzIGNoYW5nZWQgdG8gbm90IGNhbGwgbGlzdGVuZXJzXG4gICAgICAgIC8vIHRoYXQgaGF2ZSBiZWVuIHVuc3Vic2NyaWJlZCBpbiB0aGUgIG1pZGRsZSBvZiB0aGUgbm90aWZpY2F0aW9uIGxvb3AuXG5cbiAgICAgICAgdmFyIG5vdGlmeU5lc3RlZFN1YnMgPSBzdWJzY3JpcHRpb24ubm90aWZ5TmVzdGVkU3Vicy5iaW5kKHN1YnNjcmlwdGlvbik7XG4gICAgICAgIHJldHVybiBbc3Vic2NyaXB0aW9uLCBub3RpZnlOZXN0ZWRTdWJzXTtcbiAgICAgIH0sIFtzdG9yZSwgZGlkU3RvcmVDb21lRnJvbVByb3BzLCBjb250ZXh0VmFsdWVdKSxcbiAgICAgICAgICBzdWJzY3JpcHRpb24gPSBfdXNlTWVtbzJbMF0sXG4gICAgICAgICAgbm90aWZ5TmVzdGVkU3VicyA9IF91c2VNZW1vMlsxXTsgLy8gRGV0ZXJtaW5lIHdoYXQge3N0b3JlLCBzdWJzY3JpcHRpb259IHZhbHVlIHNob3VsZCBiZSBwdXQgaW50byBuZXN0ZWQgY29udGV4dCwgaWYgbmVjZXNzYXJ5LFxuICAgICAgLy8gYW5kIG1lbW9pemUgdGhhdCB2YWx1ZSB0byBhdm9pZCB1bm5lY2Vzc2FyeSBjb250ZXh0IHVwZGF0ZXMuXG5cblxuICAgICAgdmFyIG92ZXJyaWRkZW5Db250ZXh0VmFsdWUgPSAoMCwgX3JlYWN0LnVzZU1lbW8pKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKGRpZFN0b3JlQ29tZUZyb21Qcm9wcykge1xuICAgICAgICAgIC8vIFRoaXMgY29tcG9uZW50IGlzIGRpcmVjdGx5IHN1YnNjcmliZWQgdG8gYSBzdG9yZSBmcm9tIHByb3BzLlxuICAgICAgICAgIC8vIFdlIGRvbid0IHdhbnQgZGVzY2VuZGFudHMgcmVhZGluZyBmcm9tIHRoaXMgc3RvcmUgLSBwYXNzIGRvd24gd2hhdGV2ZXJcbiAgICAgICAgICAvLyB0aGUgZXhpc3RpbmcgY29udGV4dCB2YWx1ZSBpcyBmcm9tIHRoZSBuZWFyZXN0IGNvbm5lY3RlZCBhbmNlc3Rvci5cbiAgICAgICAgICByZXR1cm4gY29udGV4dFZhbHVlO1xuICAgICAgICB9IC8vIE90aGVyd2lzZSwgcHV0IHRoaXMgY29tcG9uZW50J3Mgc3Vic2NyaXB0aW9uIGluc3RhbmNlIGludG8gY29udGV4dCwgc28gdGhhdFxuICAgICAgICAvLyBjb25uZWN0ZWQgZGVzY2VuZGFudHMgd29uJ3QgdXBkYXRlIHVudGlsIGFmdGVyIHRoaXMgY29tcG9uZW50IGlzIGRvbmVcblxuXG4gICAgICAgIHJldHVybiAoMCwgX2V4dGVuZHMyW1wiZGVmYXVsdFwiXSkoe30sIGNvbnRleHRWYWx1ZSwge1xuICAgICAgICAgIHN1YnNjcmlwdGlvbjogc3Vic2NyaXB0aW9uXG4gICAgICAgIH0pO1xuICAgICAgfSwgW2RpZFN0b3JlQ29tZUZyb21Qcm9wcywgY29udGV4dFZhbHVlLCBzdWJzY3JpcHRpb25dKTsgLy8gV2UgbmVlZCB0byBmb3JjZSB0aGlzIHdyYXBwZXIgY29tcG9uZW50IHRvIHJlLXJlbmRlciB3aGVuZXZlciBhIFJlZHV4IHN0b3JlIHVwZGF0ZVxuICAgICAgLy8gY2F1c2VzIGEgY2hhbmdlIHRvIHRoZSBjYWxjdWxhdGVkIGNoaWxkIGNvbXBvbmVudCBwcm9wcyAob3Igd2UgY2F1Z2h0IGFuIGVycm9yIGluIG1hcFN0YXRlKVxuXG4gICAgICB2YXIgX3VzZVJlZHVjZXIgPSAoMCwgX3JlYWN0LnVzZVJlZHVjZXIpKHN0b3JlU3RhdGVVcGRhdGVzUmVkdWNlciwgRU1QVFlfQVJSQVksIGluaXRTdGF0ZVVwZGF0ZXMpLFxuICAgICAgICAgIF91c2VSZWR1Y2VyJCA9IF91c2VSZWR1Y2VyWzBdLFxuICAgICAgICAgIHByZXZpb3VzU3RhdGVVcGRhdGVSZXN1bHQgPSBfdXNlUmVkdWNlciRbMF0sXG4gICAgICAgICAgZm9yY2VDb21wb25lbnRVcGRhdGVEaXNwYXRjaCA9IF91c2VSZWR1Y2VyWzFdOyAvLyBQcm9wYWdhdGUgYW55IG1hcFN0YXRlL21hcERpc3BhdGNoIGVycm9ycyB1cHdhcmRzXG5cblxuICAgICAgaWYgKHByZXZpb3VzU3RhdGVVcGRhdGVSZXN1bHQgJiYgcHJldmlvdXNTdGF0ZVVwZGF0ZVJlc3VsdC5lcnJvcikge1xuICAgICAgICB0aHJvdyBwcmV2aW91c1N0YXRlVXBkYXRlUmVzdWx0LmVycm9yO1xuICAgICAgfSAvLyBTZXQgdXAgcmVmcyB0byBjb29yZGluYXRlIHZhbHVlcyBiZXR3ZWVuIHRoZSBzdWJzY3JpcHRpb24gZWZmZWN0IGFuZCB0aGUgcmVuZGVyIGxvZ2ljXG5cblxuICAgICAgdmFyIGxhc3RDaGlsZFByb3BzID0gKDAsIF9yZWFjdC51c2VSZWYpKCk7XG4gICAgICB2YXIgbGFzdFdyYXBwZXJQcm9wcyA9ICgwLCBfcmVhY3QudXNlUmVmKSh3cmFwcGVyUHJvcHMpO1xuICAgICAgdmFyIGNoaWxkUHJvcHNGcm9tU3RvcmVVcGRhdGUgPSAoMCwgX3JlYWN0LnVzZVJlZikoKTtcbiAgICAgIHZhciByZW5kZXJJc1NjaGVkdWxlZCA9ICgwLCBfcmVhY3QudXNlUmVmKShmYWxzZSk7XG4gICAgICB2YXIgYWN0dWFsQ2hpbGRQcm9wcyA9IHVzZVB1cmVPbmx5TWVtbyhmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIFRyaWNreSBsb2dpYyBoZXJlOlxuICAgICAgICAvLyAtIFRoaXMgcmVuZGVyIG1heSBoYXZlIGJlZW4gdHJpZ2dlcmVkIGJ5IGEgUmVkdXggc3RvcmUgdXBkYXRlIHRoYXQgcHJvZHVjZWQgbmV3IGNoaWxkIHByb3BzXG4gICAgICAgIC8vIC0gSG93ZXZlciwgd2UgbWF5IGhhdmUgZ290dGVuIG5ldyB3cmFwcGVyIHByb3BzIGFmdGVyIHRoYXRcbiAgICAgICAgLy8gSWYgd2UgaGF2ZSBuZXcgY2hpbGQgcHJvcHMsIGFuZCB0aGUgc2FtZSB3cmFwcGVyIHByb3BzLCB3ZSBrbm93IHdlIHNob3VsZCB1c2UgdGhlIG5ldyBjaGlsZCBwcm9wcyBhcy1pcy5cbiAgICAgICAgLy8gQnV0LCBpZiB3ZSBoYXZlIG5ldyB3cmFwcGVyIHByb3BzLCB0aG9zZSBtaWdodCBjaGFuZ2UgdGhlIGNoaWxkIHByb3BzLCBzbyB3ZSBoYXZlIHRvIHJlY2FsY3VsYXRlIHRoaW5ncy5cbiAgICAgICAgLy8gU28sIHdlJ2xsIHVzZSB0aGUgY2hpbGQgcHJvcHMgZnJvbSBzdG9yZSB1cGRhdGUgb25seSBpZiB0aGUgd3JhcHBlciBwcm9wcyBhcmUgdGhlIHNhbWUgYXMgbGFzdCB0aW1lLlxuICAgICAgICBpZiAoY2hpbGRQcm9wc0Zyb21TdG9yZVVwZGF0ZS5jdXJyZW50ICYmIHdyYXBwZXJQcm9wcyA9PT0gbGFzdFdyYXBwZXJQcm9wcy5jdXJyZW50KSB7XG4gICAgICAgICAgcmV0dXJuIGNoaWxkUHJvcHNGcm9tU3RvcmVVcGRhdGUuY3VycmVudDtcbiAgICAgICAgfSAvLyBUT0RPIFdlJ3JlIHJlYWRpbmcgdGhlIHN0b3JlIGRpcmVjdGx5IGluIHJlbmRlcigpIGhlcmUuIEJhZCBpZGVhP1xuICAgICAgICAvLyBUaGlzIHdpbGwgbGlrZWx5IGNhdXNlIEJhZCBUaGluZ3MgKFRNKSB0byBoYXBwZW4gaW4gQ29uY3VycmVudCBNb2RlLlxuICAgICAgICAvLyBOb3RlIHRoYXQgd2UgZG8gdGhpcyBiZWNhdXNlIG9uIHJlbmRlcnMgX25vdF8gY2F1c2VkIGJ5IHN0b3JlIHVwZGF0ZXMsIHdlIG5lZWQgdGhlIGxhdGVzdCBzdG9yZSBzdGF0ZVxuICAgICAgICAvLyB0byBkZXRlcm1pbmUgd2hhdCB0aGUgY2hpbGQgcHJvcHMgc2hvdWxkIGJlLlxuXG5cbiAgICAgICAgcmV0dXJuIGNoaWxkUHJvcHNTZWxlY3RvcihzdG9yZS5nZXRTdGF0ZSgpLCB3cmFwcGVyUHJvcHMpO1xuICAgICAgfSwgW3N0b3JlLCBwcmV2aW91c1N0YXRlVXBkYXRlUmVzdWx0LCB3cmFwcGVyUHJvcHNdKTsgLy8gV2UgbmVlZCB0aGlzIHRvIGV4ZWN1dGUgc3luY2hyb25vdXNseSBldmVyeSB0aW1lIHdlIHJlLXJlbmRlci4gSG93ZXZlciwgUmVhY3Qgd2FybnNcbiAgICAgIC8vIGFib3V0IHVzZUxheW91dEVmZmVjdCBpbiBTU1IsIHNvIHdlIHRyeSB0byBkZXRlY3QgZW52aXJvbm1lbnQgYW5kIGZhbGwgYmFjayB0b1xuICAgICAgLy8ganVzdCB1c2VFZmZlY3QgaW5zdGVhZCB0byBhdm9pZCB0aGUgd2FybmluZywgc2luY2UgbmVpdGhlciB3aWxsIHJ1biBhbnl3YXkuXG5cbiAgICAgIHVzZUlzb21vcnBoaWNMYXlvdXRFZmZlY3RXaXRoQXJncyhjYXB0dXJlV3JhcHBlclByb3BzLCBbbGFzdFdyYXBwZXJQcm9wcywgbGFzdENoaWxkUHJvcHMsIHJlbmRlcklzU2NoZWR1bGVkLCB3cmFwcGVyUHJvcHMsIGFjdHVhbENoaWxkUHJvcHMsIGNoaWxkUHJvcHNGcm9tU3RvcmVVcGRhdGUsIG5vdGlmeU5lc3RlZFN1YnNdKTsgLy8gT3VyIHJlLXN1YnNjcmliZSBsb2dpYyBvbmx5IHJ1bnMgd2hlbiB0aGUgc3RvcmUvc3Vic2NyaXB0aW9uIHNldHVwIGNoYW5nZXNcblxuICAgICAgdXNlSXNvbW9ycGhpY0xheW91dEVmZmVjdFdpdGhBcmdzKHN1YnNjcmliZVVwZGF0ZXMsIFtzaG91bGRIYW5kbGVTdGF0ZUNoYW5nZXMsIHN0b3JlLCBzdWJzY3JpcHRpb24sIGNoaWxkUHJvcHNTZWxlY3RvciwgbGFzdFdyYXBwZXJQcm9wcywgbGFzdENoaWxkUHJvcHMsIHJlbmRlcklzU2NoZWR1bGVkLCBjaGlsZFByb3BzRnJvbVN0b3JlVXBkYXRlLCBub3RpZnlOZXN0ZWRTdWJzLCBmb3JjZUNvbXBvbmVudFVwZGF0ZURpc3BhdGNoXSwgW3N0b3JlLCBzdWJzY3JpcHRpb24sIGNoaWxkUHJvcHNTZWxlY3Rvcl0pOyAvLyBOb3cgdGhhdCBhbGwgdGhhdCdzIGRvbmUsIHdlIGNhbiBmaW5hbGx5IHRyeSB0byBhY3R1YWxseSByZW5kZXIgdGhlIGNoaWxkIGNvbXBvbmVudC5cbiAgICAgIC8vIFdlIG1lbW9pemUgdGhlIGVsZW1lbnRzIGZvciB0aGUgcmVuZGVyZWQgY2hpbGQgY29tcG9uZW50IGFzIGFuIG9wdGltaXphdGlvbi5cblxuICAgICAgdmFyIHJlbmRlcmVkV3JhcHBlZENvbXBvbmVudCA9ICgwLCBfcmVhY3QudXNlTWVtbykoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL19yZWFjdFtcImRlZmF1bHRcIl0uY3JlYXRlRWxlbWVudChXcmFwcGVkQ29tcG9uZW50LCAoMCwgX2V4dGVuZHMyW1wiZGVmYXVsdFwiXSkoe30sIGFjdHVhbENoaWxkUHJvcHMsIHtcbiAgICAgICAgICByZWY6IHJlYWN0UmVkdXhGb3J3YXJkZWRSZWZcbiAgICAgICAgfSkpO1xuICAgICAgfSwgW3JlYWN0UmVkdXhGb3J3YXJkZWRSZWYsIFdyYXBwZWRDb21wb25lbnQsIGFjdHVhbENoaWxkUHJvcHNdKTsgLy8gSWYgUmVhY3Qgc2VlcyB0aGUgZXhhY3Qgc2FtZSBlbGVtZW50IHJlZmVyZW5jZSBhcyBsYXN0IHRpbWUsIGl0IGJhaWxzIG91dCBvZiByZS1yZW5kZXJpbmdcbiAgICAgIC8vIHRoYXQgY2hpbGQsIHNhbWUgYXMgaWYgaXQgd2FzIHdyYXBwZWQgaW4gUmVhY3QubWVtbygpIG9yIHJldHVybmVkIGZhbHNlIGZyb20gc2hvdWxkQ29tcG9uZW50VXBkYXRlLlxuXG4gICAgICB2YXIgcmVuZGVyZWRDaGlsZCA9ICgwLCBfcmVhY3QudXNlTWVtbykoZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoc2hvdWxkSGFuZGxlU3RhdGVDaGFuZ2VzKSB7XG4gICAgICAgICAgLy8gSWYgdGhpcyBjb21wb25lbnQgaXMgc3Vic2NyaWJlZCB0byBzdG9yZSB1cGRhdGVzLCB3ZSBuZWVkIHRvIHBhc3MgaXRzIG93blxuICAgICAgICAgIC8vIHN1YnNjcmlwdGlvbiBpbnN0YW5jZSBkb3duIHRvIG91ciBkZXNjZW5kYW50cy4gVGhhdCBtZWFucyByZW5kZXJpbmcgdGhlIHNhbWVcbiAgICAgICAgICAvLyBDb250ZXh0IGluc3RhbmNlLCBhbmQgcHV0dGluZyBhIGRpZmZlcmVudCB2YWx1ZSBpbnRvIHRoZSBjb250ZXh0LlxuICAgICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovX3JlYWN0W1wiZGVmYXVsdFwiXS5jcmVhdGVFbGVtZW50KENvbnRleHRUb1VzZS5Qcm92aWRlciwge1xuICAgICAgICAgICAgdmFsdWU6IG92ZXJyaWRkZW5Db250ZXh0VmFsdWVcbiAgICAgICAgICB9LCByZW5kZXJlZFdyYXBwZWRDb21wb25lbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlbmRlcmVkV3JhcHBlZENvbXBvbmVudDtcbiAgICAgIH0sIFtDb250ZXh0VG9Vc2UsIHJlbmRlcmVkV3JhcHBlZENvbXBvbmVudCwgb3ZlcnJpZGRlbkNvbnRleHRWYWx1ZV0pO1xuICAgICAgcmV0dXJuIHJlbmRlcmVkQ2hpbGQ7XG4gICAgfSAvLyBJZiB3ZSdyZSBpbiBcInB1cmVcIiBtb2RlLCBlbnN1cmUgb3VyIHdyYXBwZXIgY29tcG9uZW50IG9ubHkgcmUtcmVuZGVycyB3aGVuIGluY29taW5nIHByb3BzIGhhdmUgY2hhbmdlZC5cblxuXG4gICAgdmFyIENvbm5lY3QgPSBwdXJlID8gX3JlYWN0W1wiZGVmYXVsdFwiXS5tZW1vKENvbm5lY3RGdW5jdGlvbikgOiBDb25uZWN0RnVuY3Rpb247XG4gICAgQ29ubmVjdC5XcmFwcGVkQ29tcG9uZW50ID0gV3JhcHBlZENvbXBvbmVudDtcbiAgICBDb25uZWN0LmRpc3BsYXlOYW1lID0gQ29ubmVjdEZ1bmN0aW9uLmRpc3BsYXlOYW1lID0gZGlzcGxheU5hbWU7XG5cbiAgICBpZiAoZm9yd2FyZFJlZikge1xuICAgICAgdmFyIGZvcndhcmRlZCA9IF9yZWFjdFtcImRlZmF1bHRcIl0uZm9yd2FyZFJlZihmdW5jdGlvbiBmb3J3YXJkQ29ubmVjdFJlZihwcm9wcywgcmVmKSB7XG4gICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovX3JlYWN0W1wiZGVmYXVsdFwiXS5jcmVhdGVFbGVtZW50KENvbm5lY3QsICgwLCBfZXh0ZW5kczJbXCJkZWZhdWx0XCJdKSh7fSwgcHJvcHMsIHtcbiAgICAgICAgICByZWFjdFJlZHV4Rm9yd2FyZGVkUmVmOiByZWZcbiAgICAgICAgfSkpO1xuICAgICAgfSk7XG5cbiAgICAgIGZvcndhcmRlZC5kaXNwbGF5TmFtZSA9IGRpc3BsYXlOYW1lO1xuICAgICAgZm9yd2FyZGVkLldyYXBwZWRDb21wb25lbnQgPSBXcmFwcGVkQ29tcG9uZW50O1xuICAgICAgcmV0dXJuICgwLCBfaG9pc3ROb25SZWFjdFN0YXRpY3NbXCJkZWZhdWx0XCJdKShmb3J3YXJkZWQsIFdyYXBwZWRDb21wb25lbnQpO1xuICAgIH1cblxuICAgIHJldHVybiAoMCwgX2hvaXN0Tm9uUmVhY3RTdGF0aWNzW1wiZGVmYXVsdFwiXSkoQ29ubmVjdCwgV3JhcHBlZENvbXBvbmVudCk7XG4gIH07XG59Il19