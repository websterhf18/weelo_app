cec9edefb2c8f2ac8ec248022ecc9d0e
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});
exports.printIteratorEntries = printIteratorEntries;
exports.printIteratorValues = printIteratorValues;
exports.printListItems = printListItems;
exports.printObjectProperties = printObjectProperties;

var getKeysOfEnumerableProperties = function getKeysOfEnumerableProperties(object) {
  var keys = Object.keys(object).sort();

  if (Object.getOwnPropertySymbols) {
    Object.getOwnPropertySymbols(object).forEach(function (symbol) {
      if (Object.getOwnPropertyDescriptor(object, symbol).enumerable) {
        keys.push(symbol);
      }
    });
  }

  return keys;
};

function printIteratorEntries(iterator, config, indentation, depth, refs, printer) {
  var separator = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : ': ';
  var result = '';
  var current = iterator.next();

  if (!current.done) {
    result += config.spacingOuter;
    var indentationNext = indentation + config.indent;

    while (!current.done) {
      var name = printer(current.value[0], config, indentationNext, depth, refs);
      var value = printer(current.value[1], config, indentationNext, depth, refs);
      result += indentationNext + name + separator + value;
      current = iterator.next();

      if (!current.done) {
        result += ',' + config.spacingInner;
      } else if (!config.min) {
        result += ',';
      }
    }

    result += config.spacingOuter + indentation;
  }

  return result;
}

function printIteratorValues(iterator, config, indentation, depth, refs, printer) {
  var result = '';
  var current = iterator.next();

  if (!current.done) {
    result += config.spacingOuter;
    var indentationNext = indentation + config.indent;

    while (!current.done) {
      result += indentationNext + printer(current.value, config, indentationNext, depth, refs);
      current = iterator.next();

      if (!current.done) {
        result += ',' + config.spacingInner;
      } else if (!config.min) {
        result += ',';
      }
    }

    result += config.spacingOuter + indentation;
  }

  return result;
}

function printListItems(list, config, indentation, depth, refs, printer) {
  var result = '';

  if (list.length) {
    result += config.spacingOuter;
    var indentationNext = indentation + config.indent;

    for (var i = 0; i < list.length; i++) {
      result += indentationNext + printer(list[i], config, indentationNext, depth, refs);

      if (i < list.length - 1) {
        result += ',' + config.spacingInner;
      } else if (!config.min) {
        result += ',';
      }
    }

    result += config.spacingOuter + indentation;
  }

  return result;
}

function printObjectProperties(val, config, indentation, depth, refs, printer) {
  var result = '';
  var keys = getKeysOfEnumerableProperties(val);

  if (keys.length) {
    result += config.spacingOuter;
    var indentationNext = indentation + config.indent;

    for (var i = 0; i < keys.length; i++) {
      var key = keys[i];
      var name = printer(key, config, indentationNext, depth, refs);
      var value = printer(val[key], config, indentationNext, depth, refs);
      result += indentationNext + name + ': ' + value;

      if (i < keys.length - 1) {
        result += ',' + config.spacingInner;
      } else if (!config.min) {
        result += ',';
      }
    }

    result += config.spacingOuter + indentation;
  }

  return result;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbGxlY3Rpb25zLmpzIl0sIm5hbWVzIjpbIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwicHJpbnRJdGVyYXRvckVudHJpZXMiLCJwcmludEl0ZXJhdG9yVmFsdWVzIiwicHJpbnRMaXN0SXRlbXMiLCJwcmludE9iamVjdFByb3BlcnRpZXMiLCJnZXRLZXlzT2ZFbnVtZXJhYmxlUHJvcGVydGllcyIsIm9iamVjdCIsImtleXMiLCJzb3J0IiwiZ2V0T3duUHJvcGVydHlTeW1ib2xzIiwiZm9yRWFjaCIsInN5bWJvbCIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJwdXNoIiwiaXRlcmF0b3IiLCJjb25maWciLCJpbmRlbnRhdGlvbiIsImRlcHRoIiwicmVmcyIsInByaW50ZXIiLCJzZXBhcmF0b3IiLCJyZXN1bHQiLCJjdXJyZW50IiwibmV4dCIsImRvbmUiLCJzcGFjaW5nT3V0ZXIiLCJpbmRlbnRhdGlvbk5leHQiLCJpbmRlbnQiLCJuYW1lIiwic3BhY2luZ0lubmVyIiwibWluIiwibGlzdCIsImxlbmd0aCIsImkiLCJ2YWwiLCJrZXkiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBQSxNQUFNLENBQUNDLGNBQVAsQ0FBc0JDLE9BQXRCLEVBQStCLFlBQS9CLEVBQTZDO0FBQzNDQyxFQUFBQSxLQUFLLEVBQUU7QUFEb0MsQ0FBN0M7QUFHQUQsT0FBTyxDQUFDRSxvQkFBUixHQUErQkEsb0JBQS9CO0FBQ0FGLE9BQU8sQ0FBQ0csbUJBQVIsR0FBOEJBLG1CQUE5QjtBQUNBSCxPQUFPLENBQUNJLGNBQVIsR0FBeUJBLGNBQXpCO0FBQ0FKLE9BQU8sQ0FBQ0sscUJBQVIsR0FBZ0NBLHFCQUFoQzs7QUFTQSxJQUFNQyw2QkFBNkIsR0FBRyxTQUFoQ0EsNkJBQWdDLENBQUFDLE1BQU0sRUFBSTtBQUM5QyxNQUFNQyxJQUFJLEdBQUdWLE1BQU0sQ0FBQ1UsSUFBUCxDQUFZRCxNQUFaLEVBQW9CRSxJQUFw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WixFQUFpQjtBQUN0QlQsUUFBQUEsTUFBTSxJQUFJLEdBQVY7QUFDRDtBQUNGOztBQUVEQSxJQUFBQSxNQUFNLElBQUlOLE1BQU0sQ0FBQ1UsWUFBUCxHQUFzQlQsV0FBaEM7QUFDRDs7QUFFRCxTQUFPSyxNQUFQO0FBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5wcmludEl0ZXJhdG9yRW50cmllcyA9IHByaW50SXRlcmF0b3JFbnRyaWVzO1xuZXhwb3J0cy5wcmludEl0ZXJhdG9yVmFsdWVzID0gcHJpbnRJdGVyYXRvclZhbHVlcztcbmV4cG9ydHMucHJpbnRMaXN0SXRlbXMgPSBwcmludExpc3RJdGVtcztcbmV4cG9ydHMucHJpbnRPYmplY3RQcm9wZXJ0aWVzID0gcHJpbnRPYmplY3RQcm9wZXJ0aWVzO1xuXG4vKipcbiAqIENvcHlyaWdodCAoYykgRmFjZWJvb2ssIEluYy4gYW5kIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqL1xuY29uc3QgZ2V0S2V5c09mRW51bWVyYWJsZVByb3BlcnRpZXMgPSBvYmplY3QgPT4ge1xuICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KS5zb3J0KCk7XG5cbiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHtcbiAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCkuZm9yRWFjaChzeW1ib2wgPT4ge1xuICAgICAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW1ib2wpLmVudW1lcmFibGUpIHtcbiAgICAgICAga2V5cy5wdXNoKHN5bWJvbCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4ga2V5cztcbn07XG4vKipcbiAqIFJldHVybiBlbnRyaWVzIChmb3IgZXhhbXBsZSwgb2YgYSBtYXApXG4gKiB3aXRoIHNwYWNpbmcsIGluZGVudGF0aW9uLCBhbmQgY29tbWFcbiAqIHdpdGhvdXQgc3Vycm91bmRpbmcgcHVuY3R1YXRpb24gKGZvciBleGFtcGxlLCBicmFjZXMpXG4gKi9cblxuZnVuY3Rpb24gcHJpbnRJdGVyYXRvckVudHJpZXMoXG4gIGl0ZXJhdG9yLFxuICBjb25maWcsXG4gIGluZGVudGF0aW9uLFxuICBkZXB0aCxcbiAgcmVmcyxcbiAgcHJpbnRlciwgLy8gVG9vIGJhZCwgc28gc2FkIHRoYXQgc2VwYXJhdG9yIGZvciBFQ01BU2NyaXB0IE1hcCBoYXMgYmVlbiAnID0+ICdcbiAgLy8gV2hhdCBhIGRpc3RyYWN0aW5nIGRpZmYgaWYgeW91IGNoYW5nZSBhIGRhdGEgc3RydWN0dXJlIHRvL2Zyb21cbiAgLy8gRUNNQVNjcmlwdCBPYmplY3Qgb3IgSW1tdXRhYmxlLk1hcC9PcmRlcmVkTWFwIHdoaWNoIHVzZSB0aGUgZGVmYXVsdC5cbiAgc2VwYXJhdG9yID0gJzogJ1xuKSB7XG4gIGxldCByZXN1bHQgPSAnJztcbiAgbGV0IGN1cnJlbnQgPSBpdGVyYXRvci5uZXh0KCk7XG5cbiAgaWYgKCFjdXJyZW50LmRvbmUpIHtcbiAgICByZXN1bHQgKz0gY29uZmlnLnNwYWNpbmdPdXRlcjtcbiAgICBjb25zdCBpbmRlbnRhdGlvbk5leHQgPSBpbmRlbnRhdGlvbiArIGNvbmZpZy5pbmRlbnQ7XG5cbiAgICB3aGlsZSAoIWN1cnJlbnQuZG9uZSkge1xuICAgICAgY29uc3QgbmFtZSA9IHByaW50ZXIoXG4gICAgICAgIGN1cnJlbnQudmFsdWVbMF0sXG4gICAgICAgIGNvbmZpZyxcbiAgICAgICAgaW5kZW50YXRpb25OZXh0LFxuICAgICAgICBkZXB0aCxcbiAgICAgICAgcmVmc1xuICAgICAgKTtcbiAgICAgIGNvbnN0IHZhbHVlID0gcHJpbnRlcihcbiAgICAgICAgY3VycmVudC52YWx1ZVsxXSxcbiAgICAgICAgY29uZmlnLFxuICAgICAgICBpbmRlbnRhdGlvbk5leHQsXG4gICAgICAgIGRlcHRoLFxuICAgICAgICByZWZzXG4gICAgICApO1xuICAgICAgcmVzdWx0ICs9IGluZGVudGF0aW9uTmV4dCArIG5hbWUgKyBzZXBhcmF0b3IgKyB2YWx1ZTtcbiAgICAgIGN1cnJlbnQgPSBpdGVyYXRvci5uZXh0KCk7XG5cbiAgICAgIGlmICghY3VycmVudC5kb25lKSB7XG4gICAgICAgIHJlc3VsdCArPSAnLCcgKyBjb25maWcuc3BhY2luZ0lubmVyO1xuICAgICAgfSBlbHNlIGlmICghY29uZmlnLm1pbikge1xuICAgICAgICByZXN1bHQgKz0gJywnO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJlc3VsdCArPSBjb25maWcuc3BhY2luZ091dGVyICsgaW5kZW50YXRpb247XG4gIH1cblxuICByZXR1cm4gcmVzdWx0O1xufVxuLyoqXG4gKiBSZXR1cm4gdmFsdWVzIChmb3IgZXhhbXBsZSwgb2YgYSBzZXQpXG4gKiB3aXRoIHNwYWNpbmcsIGluZGVudGF0aW9uLCBhbmQgY29tbWFcbiAqIHdpdGhvdXQgc3Vycm91bmRpbmcgcHVuY3R1YXRpb24gKGJyYWNlcyBvciBicmFja2V0cylcbiAqL1xuXG5mdW5jdGlvbiBwcmludEl0ZXJhdG9yVmFsdWVzKFxuICBpdGVyYXRvcixcbiAgY29uZmlnLFxuICBpbmRlbnRhdGlvbixcbiAgZGVwdGgsXG4gIHJlZnMsXG4gIHByaW50ZXJcbikge1xuICBsZXQgcmVzdWx0ID0gJyc7XG4gIGxldCBjdXJyZW50ID0gaXRlcmF0b3IubmV4dCgpO1xuXG4gIGlmICghY3VycmVudC5kb25lKSB7XG4gICAgcmVzdWx0ICs9IGNvbmZpZy5zcGFjaW5nT3V0ZXI7XG4gICAgY29uc3QgaW5kZW50YXRpb25OZXh0ID0gaW5kZW50YXRpb24gKyBjb25maWcuaW5kZW50O1xuXG4gICAgd2hpbGUgKCFjdXJyZW50LmRvbmUpIHtcbiAgICAgIHJlc3VsdCArPVxuICAgICAgICBpbmRlbnRhdGlvbk5leHQgK1xuICAgICAgICBwcmludGVyKGN1cnJlbnQudmFsdWUsIGNvbmZpZywgaW5kZW50YXRpb25OZXh0LCBkZXB0aCwgcmVmcyk7XG4gICAgICBjdXJyZW50ID0gaXRlcmF0b3IubmV4dCgpO1xuXG4gICAgICBpZiAoIWN1cnJlbnQuZG9uZSkge1xuICAgICAgICByZXN1bHQgKz0gJywnICsgY29uZmlnLnNwYWNpbmdJbm5lcjtcbiAgICAgIH0gZWxzZSBpZiAoIWNvbmZpZy5taW4pIHtcbiAgICAgICAgcmVzdWx0ICs9ICcsJztcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXN1bHQgKz0gY29uZmlnLnNwYWNpbmdPdXRlciArIGluZGVudGF0aW9uO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbi8qKlxuICogUmV0dXJuIGl0ZW1zIChmb3IgZXhhbXBsZSwgb2YgYW4gYXJyYXkpXG4gKiB3aXRoIHNwYWNpbmcsIGluZGVudGF0aW9uLCBhbmQgY29tbWFcbiAqIHdpdGhvdXQgc3Vycm91bmRpbmcgcHVuY3R1YXRpb24gKGZvciBleGFtcGxlLCBicmFja2V0cylcbiAqKi9cblxuZnVuY3Rpb24gcHJpbnRMaXN0SXRlbXMobGlzdCwgY29uZmlnLCBpbmRlbnRhdGlvbiwgZGVwdGgsIHJlZnMsIHByaW50ZXIpIHtcbiAgbGV0IHJlc3VsdCA9ICcnO1xuXG4gIGlmIChsaXN0Lmxlbmd0aCkge1xuICAgIHJlc3VsdCArPSBjb25maWcuc3BhY2luZ091dGVyO1xuICAgIGNvbnN0IGluZGVudGF0aW9uTmV4dCA9IGluZGVudGF0aW9uICsgY29uZmlnLmluZGVudDtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgcmVzdWx0ICs9XG4gICAgICAgIGluZGVudGF0aW9uTmV4dCArXG4gICAgICAgIHByaW50ZXIobGlzdFtpXSwgY29uZmlnLCBpbmRlbnRhdGlvbk5leHQsIGRlcHRoLCByZWZzKTtcblxuICAgICAgaWYgKGkgPCBsaXN0Lmxlbmd0aCAtIDEpIHtcbiAgICAgICAgcmVzdWx0ICs9ICcsJyArIGNvbmZpZy5zcGFjaW5nSW5uZXI7XG4gICAgICB9IGVsc2UgaWYgKCFjb25maWcubWluKSB7XG4gICAgICAgIHJlc3VsdCArPSAnLCc7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmVzdWx0ICs9IGNvbmZpZy5zcGFjaW5nT3V0ZXIgKyBpbmRlbnRhdGlvbjtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59XG4vKipcbiAqIFJldHVybiBwcm9wZXJ0aWVzIG9mIGFuIG9iamVjdFxuICogd2l0aCBzcGFjaW5nLCBpbmRlbnRhdGlvbiwgYW5kIGNvbW1hXG4gKiB3aXRob3V0IHN1cnJvdW5kaW5nIHB1bmN0dWF0aW9uIChmb3IgZXhhbXBsZSwgYnJhY2VzKVxuICovXG5cbmZ1bmN0aW9uIHByaW50T2JqZWN0UHJvcGVydGllcyh2YWwsIGNvbmZpZywgaW5kZW50YXRpb24sIGRlcHRoLCByZWZzLCBwcmludGVyKSB7XG4gIGxldCByZXN1bHQgPSAnJztcbiAgY29uc3Qga2V5cyA9IGdldEtleXNPZkVudW1lcmFibGVQcm9wZXJ0aWVzKHZhbCk7XG5cbiAgaWYgKGtleXMubGVuZ3RoKSB7XG4gICAgcmVzdWx0ICs9IGNvbmZpZy5zcGFjaW5nT3V0ZXI7XG4gICAgY29uc3QgaW5kZW50YXRpb25OZXh0ID0gaW5kZW50YXRpb24gKyBjb25maWcuaW5kZW50O1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBrZXkgPSBrZXlzW2ldO1xuICAgICAgY29uc3QgbmFtZSA9IHByaW50ZXIoa2V5LCBjb25maWcsIGluZGVudGF0aW9uTmV4dCwgZGVwdGgsIHJlZnMpO1xuICAgICAgY29uc3QgdmFsdWUgPSBwcmludGVyKHZhbFtrZXldLCBjb25maWcsIGluZGVudGF0aW9uTmV4dCwgZGVwdGgsIHJlZnMpO1xuICAgICAgcmVzdWx0ICs9IGluZGVudGF0aW9uTmV4dCArIG5hbWUgKyAnOiAnICsgdmFsdWU7XG5cbiAgICAgIGlmIChpIDwga2V5cy5sZW5ndGggLSAxKSB7XG4gICAgICAgIHJlc3VsdCArPSAnLCcgKyBjb25maWcuc3BhY2luZ0lubmVyO1xuICAgICAgfSBlbHNlIGlmICghY29uZmlnLm1pbikge1xuICAgICAgICByZXN1bHQgKz0gJywnO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJlc3VsdCArPSBjb25maWcuc3BhY2luZ091dGVyICsgaW5kZW50YXRpb247XG4gIH1cblxuICByZXR1cm4gcmVzdWx0O1xufVxuIl19