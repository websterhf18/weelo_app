{"version":3,"sources":["useSelector.js"],"names":["_interopRequireDefault","require","exports","__esModule","createSelectorHook","useSelector","_react","_useReduxContext2","_Subscription","_useIsomorphicLayoutEffect","_Context","refEquality","a","b","useSelectorWithStoreAndSubscription","selector","equalityFn","store","contextSub","_useReducer","useReducer","s","forceRender","subscription","useMemo","latestSubscriptionCallbackError","useRef","latestSelector","latestStoreState","latestSelectedState","storeState","getState","selectedState","current","newSelectedState","undefined","err","message","stack","useIsomorphicLayoutEffect","checkForUpdates","newStoreState","_newSelectedState","onStateChange","trySubscribe","tryUnsubscribe","context","ReactReduxContext","useReduxContext","useContext","process","env","NODE_ENV","Error","_useReduxContext","useDebugValue"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.createSelectorHook = createSelectorHook;\nexports.useSelector = void 0;\n\nvar _react = require(\"react\");\n\nvar _useReduxContext2 = require(\"./useReduxContext\");\n\nvar _Subscription = _interopRequireDefault(require(\"../utils/Subscription\"));\n\nvar _useIsomorphicLayoutEffect = require(\"../utils/useIsomorphicLayoutEffect\");\n\nvar _Context = require(\"../components/Context\");\n\nvar refEquality = function refEquality(a, b) {\n  return a === b;\n};\n\nfunction useSelectorWithStoreAndSubscription(selector, equalityFn, store, contextSub) {\n  var _useReducer = (0, _react.useReducer)(function (s) {\n    return s + 1;\n  }, 0),\n      forceRender = _useReducer[1];\n\n  var subscription = (0, _react.useMemo)(function () {\n    return new _Subscription[\"default\"](store, contextSub);\n  }, [store, contextSub]);\n  var latestSubscriptionCallbackError = (0, _react.useRef)();\n  var latestSelector = (0, _react.useRef)();\n  var latestStoreState = (0, _react.useRef)();\n  var latestSelectedState = (0, _react.useRef)();\n  var storeState = store.getState();\n  var selectedState;\n\n  try {\n    if (selector !== latestSelector.current || storeState !== latestStoreState.current || latestSubscriptionCallbackError.current) {\n      var newSelectedState = selector(storeState); // ensure latest selected state is reused so that a custom equality function can result in identical references\n\n      if (latestSelectedState.current === undefined || !equalityFn(newSelectedState, latestSelectedState.current)) {\n        selectedState = newSelectedState;\n      } else {\n        selectedState = latestSelectedState.current;\n      }\n    } else {\n      selectedState = latestSelectedState.current;\n    }\n  } catch (err) {\n    if (latestSubscriptionCallbackError.current) {\n      err.message += \"\\nThe error may be correlated with this previous error:\\n\" + latestSubscriptionCallbackError.current.stack + \"\\n\\n\";\n    }\n\n    throw err;\n  }\n\n  (0, _useIsomorphicLayoutEffect.useIsomorphicLayoutEffect)(function () {\n    latestSelector.current = selector;\n    latestStoreState.current = storeState;\n    latestSelectedState.current = selectedState;\n    latestSubscriptionCallbackError.current = undefined;\n  });\n  (0, _useIsomorphicLayoutEffect.useIsomorphicLayoutEffect)(function () {\n    function checkForUpdates() {\n      try {\n        var newStoreState = store.getState();\n\n        var _newSelectedState = latestSelector.current(newStoreState);\n\n        if (equalityFn(_newSelectedState, latestSelectedState.current)) {\n          return;\n        }\n\n        latestSelectedState.current = _newSelectedState;\n        latestStoreState.current = newStoreState;\n      } catch (err) {\n        // we ignore all errors here, since when the component\n        // is re-rendered, the selectors are called again, and\n        // will throw again, if neither props nor store state\n        // changed\n        latestSubscriptionCallbackError.current = err;\n      }\n\n      forceRender();\n    }\n\n    subscription.onStateChange = checkForUpdates;\n    subscription.trySubscribe();\n    checkForUpdates();\n    return function () {\n      return subscription.tryUnsubscribe();\n    };\n  }, [store, subscription]);\n  return selectedState;\n}\n/**\r\n * Hook factory, which creates a `useSelector` hook bound to a given context.\r\n *\r\n * @param {React.Context} [context=ReactReduxContext] Context passed to your `<Provider>`.\r\n * @returns {Function} A `useSelector` hook bound to the specified context.\r\n */\n\n\nfunction createSelectorHook(context) {\n  if (context === void 0) {\n    context = _Context.ReactReduxContext;\n  }\n\n  var useReduxContext = context === _Context.ReactReduxContext ? _useReduxContext2.useReduxContext : function () {\n    return (0, _react.useContext)(context);\n  };\n  return function useSelector(selector, equalityFn) {\n    if (equalityFn === void 0) {\n      equalityFn = refEquality;\n    }\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (!selector) {\n        throw new Error(\"You must pass a selector to useSelector\");\n      }\n\n      if (typeof selector !== 'function') {\n        throw new Error(\"You must pass a function as a selector to useSelector\");\n      }\n\n      if (typeof equalityFn !== 'function') {\n        throw new Error(\"You must pass a function as an equality function to useSelector\");\n      }\n    }\n\n    var _useReduxContext = useReduxContext(),\n        store = _useReduxContext.store,\n        contextSub = _useReduxContext.subscription;\n\n    var selectedState = useSelectorWithStoreAndSubscription(selector, equalityFn, store, contextSub);\n    (0, _react.useDebugValue)(selectedState);\n    return selectedState;\n  };\n}\n/**\r\n * A hook to access the redux store's state. This hook takes a selector function\r\n * as an argument. The selector is called with the store state.\r\n *\r\n * This hook takes an optional equality comparison function as the second parameter\r\n * that allows you to customize the way the selected state is compared to determine\r\n * whether the component needs to be re-rendered.\r\n *\r\n * @param {Function} selector the selector function\r\n * @param {Function=} equalityFn the function that will be used to determine equality\r\n *\r\n * @returns {any} the selected state\r\n *\r\n * @example\r\n *\r\n * import React from 'react'\r\n * import { useSelector } from 'react-redux'\r\n *\r\n * export const CounterComponent = () => {\r\n *   const counter = useSelector(state => state.counter)\r\n *   return <div>{counter}</div>\r\n * }\r\n */\n\n\nvar useSelector = /*#__PURE__*/createSelectorHook();\nexports.useSelector = useSelector;"]}