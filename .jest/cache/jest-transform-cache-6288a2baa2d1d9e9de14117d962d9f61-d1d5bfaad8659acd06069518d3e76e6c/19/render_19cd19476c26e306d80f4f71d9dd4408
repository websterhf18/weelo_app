272c0299922eb6ae418dee34d41a942e
"use strict";

var _interopRequireDefault2 = require("@babel/runtime/helpers/interopRequireDefault");

var _extends2 = _interopRequireDefault2(require("@babel/runtime/helpers/extends"));

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = render;

var React = _interopRequireWildcard(require("react"));

var _reactTestRenderer = _interopRequireDefault(require("react-test-renderer"));

var _act = _interopRequireDefault(require("./act"));

var _cleanup = require("./cleanup");

var _getByAPI = require("./helpers/getByAPI");

var _queryByAPI = require("./helpers/queryByAPI");

var _findByAPI = require("./helpers/findByAPI");

var _a11yAPI = require("./helpers/a11yAPI");

var _debugShallow = _interopRequireDefault(require("./helpers/debugShallow"));

var _debugDeep = _interopRequireDefault(require("./helpers/debugDeep"));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function _getRequireWildcardCache() {
  if (typeof WeakMap !== "function") return null;
  var cache = new WeakMap();

  _getRequireWildcardCache = function _getRequireWildcardCache() {
    return cache;
  };

  return cache;
}

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  }

  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }

  var cache = _getRequireWildcardCache();

  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }

  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;

  for (var key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;

      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }

  newObj.default = obj;

  if (cache) {
    cache.set(obj, newObj);
  }

  return newObj;
}

function render(component) {
  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
      Wrapper = _ref.wrapper,
      createNodeMock = _ref.createNodeMock;

  var wrap = function wrap(innerElement) {
    return Wrapper ? React.createElement(Wrapper, null, innerElement) : innerElement;
  };

  var renderer = renderWithAct(wrap(component), createNodeMock ? {
    createNodeMock: createNodeMock
  } : undefined);
  var update = updateWithAct(renderer, wrap);
  var instance = renderer.root;
  (0, _cleanup.addToCleanupQueue)(renderer.unmount);
  return (0, _extends2.default)({}, (0, _getByAPI.getByAPI)(instance), (0, _queryByAPI.queryByAPI)(instance), (0, _findByAPI.findByAPI)(instance), (0, _a11yAPI.a11yAPI)(instance), {
    update: update,
    container: instance,
    rerender: update,
    unmount: renderer.unmount,
    toJSON: renderer.toJSON,
    debug: debug(instance, renderer)
  });
}

function renderWithAct(component, options) {
  var renderer;
  (0, _act.default)(function () {
    renderer = _reactTestRenderer.default.create(component, options);
  });
  return renderer;
}

function updateWithAct(renderer, wrap) {
  return function (component) {
    (0, _act.default)(function () {
      renderer.update(wrap(component));
    });
  };
}

function debug(instance, renderer) {
  function debugImpl(message) {
    return (0, _debugDeep.default)(renderer.toJSON(), message);
  }

  debugImpl.shallow = function (message) {
    return (0, _debugShallow.default)(instance, message);
  };

  return debugImpl;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlbmRlci5qcyJdLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsImRlZmF1bHQiLCJyZW5kZXIiLCJSZWFjdCIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwicmVxdWlyZSIsIl9yZWFjdFRlc3RSZW5kZXJlciIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfYWN0IiwiX2NsZWFudXAiLCJfZ2V0QnlBUEkiLCJfcXVlcnlCeUFQSSIsIl9maW5kQnlBUEkiLCJfYTExeUFQSSIsIl9kZWJ1Z1NoYWxsb3ciLCJfZGVidWdEZWVwIiwib2JqIiwiX19lc01vZHVsZSIsIl9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSIsIldlYWtNYXAiLCJjYWNoZSIsImhhcyIsImdldCIsIm5ld09iaiIsImhhc1Byb3BlcnR5RGVzY3JpcHRvciIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImtleSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImRlc2MiLCJzZXQiLCJjb21wb25lbnQiLCJXcmFwcGVyIiwid3JhcHBlciIsImNyZWF0ZU5vZGVNb2NrIiwid3JhcCIsImlubmVyRWxlbWVudCIsImNyZWF0ZUVsZW1lbnQiLCJyZW5kZXJlciIsInJlbmRlcldpdGhBY3QiLCJ1bmRlZmluZWQiLCJ1cGRhdGUiLCJ1cGRhdGVXaXRoQWN0IiwiaW5zdGFuY2UiLCJyb290IiwiYWRkVG9DbGVhbnVwUXVldWUiLCJ1bm1vdW50IiwiZ2V0QnlBUEkiLCJxdWVyeUJ5QVBJIiwiZmluZEJ5QVBJIiwiYTExeUFQSSIsImNvbnRhaW5lciIsInJlcmVuZGVyIiwidG9KU09OIiwiZGVidWciLCJvcHRpb25zIiwiY3JlYXRlIiwiZGVidWdJbXBsIiwibWVzc2FnZSIsInNoYWxsb3ciXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7QUFFQUEsTUFBTSxDQUFDQyxjQUFQLENBQXNCQyxPQUF0QixFQUErQixZQUEvQixFQUE2QztB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QSxXQUFJLENBQUMsR0FBRzdDLGFBQWEsQ0FBQ2IsT0FBbEIsRUFBMkIyQyxRQUEzQixFQUFxQ2UsT0FBckMsQ0FBSjtBQUFBLEdBQTNCOztBQUVBLFNBQU9ELFNBQVA7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gcmVuZGVyO1xuXG52YXIgUmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKFwicmVhY3RcIikpO1xuXG52YXIgX3JlYWN0VGVzdFJlbmRlcmVyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwicmVhY3QtdGVzdC1yZW5kZXJlclwiKSk7XG5cbnZhciBfYWN0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9hY3RcIikpO1xuXG52YXIgX2NsZWFudXAgPSByZXF1aXJlKFwiLi9jbGVhbnVwXCIpO1xuXG52YXIgX2dldEJ5QVBJID0gcmVxdWlyZShcIi4vaGVscGVycy9nZXRCeUFQSVwiKTtcblxudmFyIF9xdWVyeUJ5QVBJID0gcmVxdWlyZShcIi4vaGVscGVycy9xdWVyeUJ5QVBJXCIpO1xuXG52YXIgX2ZpbmRCeUFQSSA9IHJlcXVpcmUoXCIuL2hlbHBlcnMvZmluZEJ5QVBJXCIpO1xuXG52YXIgX2ExMXlBUEkgPSByZXF1aXJlKFwiLi9oZWxwZXJzL2ExMXlBUElcIik7XG5cbnZhciBfZGVidWdTaGFsbG93ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9oZWxwZXJzL2RlYnVnU2hhbGxvd1wiKSk7XG5cbnZhciBfZGVidWdEZWVwID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9oZWxwZXJzL2RlYnVnRGVlcFwiKSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSgpIHsgaWYgKHR5cGVvZiBXZWFrTWFwICE9PSBcImZ1bmN0aW9uXCIpIHJldHVybiBudWxsOyB2YXIgY2FjaGUgPSBuZXcgV2Vha01hcCgpOyBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBjYWNoZTsgfTsgcmV0dXJuIGNhY2hlOyB9XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqICE9PSBcIm9iamVjdFwiICYmIHR5cGVvZiBvYmogIT09IFwiZnVuY3Rpb25cIikgeyByZXR1cm4geyBkZWZhdWx0OiBvYmogfTsgfSB2YXIgY2FjaGUgPSBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUoKTsgaWYgKGNhY2hlICYmIGNhY2hlLmhhcyhvYmopKSB7IHJldHVybiBjYWNoZS5nZXQob2JqKTsgfSB2YXIgbmV3T2JqID0ge307IHZhciBoYXNQcm9wZXJ0eURlc2NyaXB0b3IgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgeyB2YXIgZGVzYyA9IGhhc1Byb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDogbnVsbDsgaWYgKGRlc2MgJiYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOyB9IGVsc2UgeyBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgaWYgKGNhY2hlKSB7IGNhY2hlLnNldChvYmosIG5ld09iaik7IH0gcmV0dXJuIG5ld09iajsgfVxuXG4vLyBlc2xpbnQtZGlzYWJsZS1saW5lIGltcG9ydC9uby1leHRyYW5lb3VzLWRlcGVuZGVuY2llc1xuXG4vKipcbiAqIFJlbmRlcnMgdGVzdCBjb21wb25lbnQgZGVlcGx5IHVzaW5nIHJlYWN0LXRlc3QtcmVuZGVyZXIgYW5kIGV4cG9zZXMgaGVscGVyc1xuICogdG8gYXNzZXJ0IG9uIHRoZSBvdXRwdXQuXG4gKi9cbmZ1bmN0aW9uIHJlbmRlcihjb21wb25lbnQsIHtcbiAgd3JhcHBlcjogV3JhcHBlcixcbiAgY3JlYXRlTm9kZU1vY2tcbn0gPSB7fSkge1xuICBjb25zdCB3cmFwID0gaW5uZXJFbGVtZW50ID0+IFdyYXBwZXIgPyAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChXcmFwcGVyLCBudWxsLCBpbm5lckVsZW1lbnQpIDogaW5uZXJFbGVtZW50O1xuXG4gIGNvbnN0IHJlbmRlcmVyID0gcmVuZGVyV2l0aEFjdCh3cmFwKGNvbXBvbmVudCksIGNyZWF0ZU5vZGVNb2NrID8ge1xuICAgIGNyZWF0ZU5vZGVNb2NrXG4gIH0gOiB1bmRlZmluZWQpO1xuICBjb25zdCB1cGRhdGUgPSB1cGRhdGVXaXRoQWN0KHJlbmRlcmVyLCB3cmFwKTtcbiAgY29uc3QgaW5zdGFuY2UgPSByZW5kZXJlci5yb290O1xuICAoMCwgX2NsZWFudXAuYWRkVG9DbGVhbnVwUXVldWUpKHJlbmRlcmVyLnVubW91bnQpO1xuICByZXR1cm4geyAuLi4oMCwgX2dldEJ5QVBJLmdldEJ5QVBJKShpbnN0YW5jZSksXG4gICAgLi4uKDAsIF9xdWVyeUJ5QVBJLnF1ZXJ5QnlBUEkpKGluc3RhbmNlKSxcbiAgICAuLi4oMCwgX2ZpbmRCeUFQSS5maW5kQnlBUEkpKGluc3RhbmNlKSxcbiAgICAuLi4oMCwgX2ExMXlBUEkuYTExeUFQSSkoaW5zdGFuY2UpLFxuICAgIHVwZGF0ZSxcbiAgICBjb250YWluZXI6IGluc3RhbmNlLFxuICAgIHJlcmVuZGVyOiB1cGRhdGUsXG4gICAgLy8gYWxpYXMgZm9yIGB1cGRhdGVgXG4gICAgdW5tb3VudDogcmVuZGVyZXIudW5tb3VudCxcbiAgICB0b0pTT046IHJlbmRlcmVyLnRvSlNPTixcbiAgICBkZWJ1ZzogZGVidWcoaW5zdGFuY2UsIHJlbmRlcmVyKVxuICB9O1xufVxuXG5mdW5jdGlvbiByZW5kZXJXaXRoQWN0KGNvbXBvbmVudCwgb3B0aW9ucykge1xuICBsZXQgcmVuZGVyZXI7XG4gICgwLCBfYWN0LmRlZmF1bHQpKCgpID0+IHtcbiAgICByZW5kZXJlciA9IF9yZWFjdFRlc3RSZW5kZXJlci5kZWZhdWx0LmNyZWF0ZShjb21wb25lbnQsIG9wdGlvbnMpO1xuICB9KTtcbiAgcmV0dXJuIHJlbmRlcmVyO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVXaXRoQWN0KHJlbmRlcmVyLCB3cmFwKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoY29tcG9uZW50KSB7XG4gICAgKDAsIF9hY3QuZGVmYXVsdCkoKCkgPT4ge1xuICAgICAgcmVuZGVyZXIudXBkYXRlKHdyYXAoY29tcG9uZW50KSk7XG4gICAgfSk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGRlYnVnKGluc3RhbmNlLCByZW5kZXJlcikge1xuICBmdW5jdGlvbiBkZWJ1Z0ltcGwobWVzc2FnZSkge1xuICAgIHJldHVybiAoMCwgX2RlYnVnRGVlcC5kZWZhdWx0KShyZW5kZXJlci50b0pTT04oKSwgbWVzc2FnZSk7XG4gIH1cblxuICBkZWJ1Z0ltcGwuc2hhbGxvdyA9IG1lc3NhZ2UgPT4gKDAsIF9kZWJ1Z1NoYWxsb3cuZGVmYXVsdCkoaW5zdGFuY2UsIG1lc3NhZ2UpO1xuXG4gIHJldHVybiBkZWJ1Z0ltcGw7XG59Il19